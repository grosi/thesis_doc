%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Titel:   Konzept
% Autor:   zursr1, gross10
% Datum:   28.05.2014
% Version: 0.0.1
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%:::Change-Log:::
% Versionierung erfolgt auf folgende Gegebenheiten: -1. Release Versionen
%                                                   -2. Neue Kapitel
%                                                   -3. Fehlerkorrekturen
%
% 0.0.0       Erstellung der Datei
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Konzept}\label{ch:konzept}
%
% Blockdiagramm
\section{Algoritmus}\label{s:blockdiagramm}
Das Konzept kann teilweise aus einem \gls{g:labview}-Beispielprojekt \textsf{Posture Estimation} von \gls{ac:ni} extrahiert werden. Dort wurde eine ähnliche Aufgabenstellung gelöst. Nach der Literaturstudie und der Absprache mit den Betreuern haben sich die Autoren entschieden, die Methode mit der doppelten Integration der Beschleunigung der Bewegung umzusetzen, wie in der Literaturstudie in \cite{lit:doubleint} gesehen.\par
%
Die Beschleunigung der Bewegung wird von einem auf dem Knie montierten Drei-Achsen-Beschleunigungssensor aufgezeichnet. Da der Sensor beliebig im Raum platziert ist, enthalten die aufgezeichneten Beschleunigungsdaten zum einen die Erdbeschleunigung zum andern die Bewegungsbeschleunigung. In unserem Fall ist nur die Beschleunigung der Bewegung von Interesse. Somit muss die Erdbeschleunigung detektiert und diese von der Bewegungsbeschleunigung getrennt werden. Dies erreicht man durch die Kompensation der Orientierung des Sensors. Dafür wird die statische Erdbeschleunigung ausgenutzt. Diese zeigt stets in Richtung der z-Achse des Koordinatensystems des Betrachters, dem \gls{g:worldframe}. Die zu detektierende Bewegung, welche einer seitlichen Auslenkung des Knies entspricht, wird nur in einer Ebene senkrecht zur Erdbeschleunigung betrachtet. Diese Vereinfachung ist möglich, da mit dieser Auslenkung in dieser Ebene bereits ein genügend genaues Urteil über die Gesundheit des Kreuzbandes gefällt werden kann. Die Bewegung wird also nur in der x-y-Ebene ausgewertet. Die Beschleunigungskomponenten der x- und y-Achse sind zweimal zu integrieren, um auf die Bewegung zu schliessen.\par
%
Zu Beginn jeder Messung wird der Beschleunigungssensor während einer definierte Zeit nicht bewegt. In dieser Zeit wird die Orientierung des Beschleunigungssensors bestimmt. Anschliessend wird die Orientierung des Sensors kompensiert und die Bewegung in der x-y-Ebene berechnet. Der Algorithmus kann in zwei Teile aufgeteilt werden. Der erste Teil wird während der Zeit abgearbeitet, in welcher der Sensor nicht bewegt wird. Diese Zeit entspricht einer Kalibrationsphase. Im zweiten Teil, der Bewegungsphase, wird die Bewegung des Sensors in der Integrationsebene berechnet.\par
%
Das Blockdiagramm des Konzeptes ist in Abbildung \vref{img:blockdiagramm} ersichtlich. Auf die einzelnen Blöcke soll in den folgenden Unterkapiteln näher eingegangen werden.
%
% Blockdiagramm
\image{content/3_konzept/image/Konzept_final_bilinear}{scale=0.9}{t}[Blockdiagramm Konzept][img:blockdiagramm]
%
% Filterung
\subsection{Filterung der Sensordaten}\label{ss:tp}
Die Erdbeschleunigung ist in jedem Falle eine konstante Beschleunigung. Aus diesem Grund kann diese Beschleunigung als eine \glqq DC-Komponente\grqq\ betrachtet werden. Mit einer \gls{ac:tp}-Filterung kann somit die Erdbeschleunigung von der Beschleunigung der Bewegung getrennt werden. Als Filter wird ein \gls{ac:iir}-Filter verwendet. Wie der Name bereits sagt, hat dieses Filter eine unendlich lange Impulsantwort. Der Aufbau eines solchen Filters N-ter Ordnung ist folgendermassen.
%
\formula{
H(z)=\frac{b_0 + b_1z^{-1}+...+b_Nz^{-N}}{a_0 + a_1z^{-1}+...+a_Nz^{-N}}
}{
}[eq:iir_Filter]
%
Dabei sind $a_n$ und $b_n$ die jeweiligen Filterkoeffizienten. Ein Vorteil des \gls{ac:iir}-Filters und der Grund weshalb es dem \gls{ac:fir}-Filter oft vorgezogen wird, ist, dass es eine grössere Effizienz auf eine kurze Verzögerung aufweist. Um mit einem \gls{ac:fir}-Filter dieselbe Filterwirkung wie mit einem \gls{ac:iir}-Filter zu erreichen ist eine deutlich grössere Filterordnung nötig. Somit vergrössert sich, wie erwähnt, die Verzögerung durch das Filter. Ein Nachteil ist, dass durch den rekursiven Aufbau das \gls{ac:iir}-Filter instabil sein kann.
% 
\subsubsection*{Filterentwurf}\label{subsub:filterentwurf}
Ein vielfach verwendetes Verfahren zum Entwurf von \gls{ac:iir}-Filtern ist die Bilineare-Transforma\-tion. Hierbei wird die Übertragungsfunktion $H(s)$ eines Analogfilters in die Übertragungsfunktion $H(z)$ eines Digitalfilters überführt. Das Analogfilter entspricht dabei einem zeitkontinuierlichem \gls{g:lti}-System, das Digitalfilter bekanntlich einem zeitdiskreten \gls{g:lti}-System. Ein Ansatz ist, die Labplacevariable $s$ durch eine Funktion der Variablen $z$ zu substituieren. Im Unterrichtsmodul Digitale Signalverarbeitung (BTE5034 DIGSV) hat sich gezeigt, dass die Substitution 
%
\formula{
s = \frac{2}{T_a}*\frac{1-z^{-1}}{1+z^{-1}}
}{
}[eq:bilinear_trans]
%
dazu benötigt wird. Diese Substitution wird Bilineare-Transformation genannt. Mit der bekannten Übertragungsfunktion des Analogfilters und der Abtastrate $T_a$ kann somit das Digitalfilter entworfen werden. Die Bilineare-Transformation wird zu einem späteren Zeitpunkt in Abschnitt \vref{ss:int} verwendet.\par
%
Eine weitere Möglichkeit zum Entwurf eines \gls{ac:iir}-Filters bieten heute Entwurfsprogramme. In \gls{g:matlab} kann zum Entwurf mit Befehlen wie \texttt{butter}, \texttt{cheby1}, \texttt{ellip} gearbeitet werden. Im \gls{g:labview}-Beispielprojekt \textsf{Posture Estimation} wird ein elliptisches Filter eingesetzt. Diese elliptische Approximation hat einen welligen Bereich im Durchlass- sowie im Sperrbereich. Es wird durch ein butterworth Filter ersetzt, welches im Durchlass- und im Sperrbereich einen monotonen Amplitudengang aufweist.\par
%
% Filterentwurf
\image{content/3_konzept/image/filterentwurf}{scale=0.8}{htbp}[Spezifikationen eines Tiefpassfilters \cite{img:filterentwurf}][img:spezfilter] 
%
Zum Entwurf des Filters müssen zuerst seine Spezifikationen des Filters festgelegt werden. Im Beispielprojekt wurde, wie schon erwähnt, ein elliptisches Filter verwendet. Die Ordnung wurde dort auf 2 gesetzt. Die Sperrfrequenz auf \unit[30]{Hz}. Die Sperrfrequenz sowie die Ordnung wurde wie im Beispielprojekt festgelegt, einzig der Filtertyp wurde auf ein butterworth Filter angepasst. Die Sperrfrequenz muss jedoch noch angepasst werden, wie sich später zeigen wird.  
%
\begin{itemize}
\item f\low{stop} = \unit[30]{Hz}: Sperrfrequenz
\item N = 2: Filterordnung
\end{itemize}
%
Der Filterentwurf kann anschliessend in \gls{g:matlab} mit dem Befehl \texttt{butter} erfolgen.
%
\begin{lstlisting}[style=Matlab,caption={Butterworth-Filterentwurf mit butter()},label={list:butter}]
fs = 30;       % Sperrfrequenz [Hz]
fs_norm = fs/(fa/2);  % Normierung auf halbe Abtastfrequenz
Ordnung = 2;    % Ordnung des Filters

[b_TP,a_TP] = butter(Ordnung,fs_norm);
\end{lstlisting}
%
Die Filterkoeffizienten sind in $b_{TP}$ und $a_{TP}$ abgelegt und können mit der Funktion  \texttt{filter} auf das Signal angewendet werden.
% 
\begin{lstlisting}[style=Matlab,caption={Anwenden des Filters},label={list:filter}]
% Tiefpassfilterung
axfilt = filter(b_TP,a_TP,ax); 
\end{lstlisting}
%
%Die aufgenommenen Beschleunigungsdaten werden aufgetrennt in die Erdbeschleunigung und die Beschleunigung der Bewegung. Die Erdbeschleunigung ermöglicht das Schätzen der Orientierung wie dies in Abschnitt \vref{subsec:orientierungsschätzung} genauer erklärt ist.\par
%%
%Die Erdbeschleunigung ist in jedem Falle eine konstante Beschleunigung. Aus diesem Grund kann diese Beschleunigung als eine reine DC-Komponente betrachtet werden. Mit einer Tiefpass-Filterung kann somit die Erdbeschleunigung von der Beschleunigung der Bewegung getrennt werden. Als Tiefpassfilter wurde ein \gls{ac:fir}-Filter gewählt.  Dies aus dem Grund, da das \gls{ac:fir}-Filter eine lineare Phase hat.
%%
%% Filterentwurf
%\subsubsection*{Filterentwurf}
%Das verwendete \gls{ac:fir}-Filter hat, wie der Name schon aussagt eine endliche Impulsantwort und ist somit gezwungen stabil. Der Phasengang dieser Filter ist linear. Die Gruppenlaufzeit entspricht der Zeit, durch die das Eingangssignal eines \gls{ac:lti}-Systems verzögert wird. Diese ist durch die lineare Phase bei einem \gls{ac:fir}-Filter für alle Frequenzanteile konstant. Das Eingangssignal ist also am Ausgang nur verzögert und nicht verzerrt.\cite{lit:vongruenigen}\par
%%
%Zum Entwurf des Filters müssen zuerst einige Spezifikationen des Filters festgelegt werden. Diese sind in der Abbildung \vref{img:spezfilter} ersichtlich und sind:
%%
%\begin{itemize}
%\item f\low{pass}: Durchlassfrequenz
%\item f\low{stop}: Sperrfrequenz
%\item A\low{pass}: Rippel im Durchlassbereich
%\item A\low{stop}: Dämpfung im Sperrbereich 
%\end{itemize}
%%
%% Filterentwurf
%\image{content/3_konzept/image/filterentwurf}{scale=0.6}{htbp}[Spezifikationen eines Tiefpassfilters \cite{img:filterentwurf}][img:spezfilter] 
%%
%\subsubsection*{Fenstermethode}
%Zum Entwurf des Filters wurde die einfachste sogenannte Fenstermethode gewählt. Bei dieser Methode geht man vom idealen Frequenzgang des Filters aus. Dieser Frequenzgang hat im Falle eines \gls{ac:tp}-Filters bis zur Durchlassfrequenz f\low{pass} den Wert 1, bei grösseren Frequenzen den Wert 0. Aus dem Frequenzgang H\low{ideal}($e^{j\Omega}$) kann man mit der inversen Fourier-Analyse auf die Impulsantwort h\low{ideal}(n) des Filters schliessen wie in Gleichung \vref{eq:invfourier} aus \cite{lit:vongruenigen} beschrieben.
%%
%\formula{
%h_{ideal}(n) &= \frac{1}{2\pi}\int_{-\pi}^{\pi} H_{ideal}(e^{j\Omega})*e^{j\Omega n}d\Omega\\
%\Omega &= k\frac{2\pi}{N}
%}{
%h_{ideal} & ideale Impulsantwort\\
%H_{ideal} & idealer Frequenzgang\\
%N & Anzahl Samples 
%}[eq:invfourier] \todo{N richtig benamsen/überprüfen}
%%
%Diese ideale Impulsantwort ist durch den Sprung an der Durchlassfrequenz unendlich lang und somit nicht realisierbar. Eine einfache Lösung ist, die Impulsantwort mit einem Fenster zu begrenzen. Somit erhält man die Impulsantwort des \gls{ac:fir}-Filters wie in Gleichung \vref{eq:impfir} durch die Multiplikation des Fensters mit der idealer Impulsantwort des Filters.
%%
%\formula{
%h[n]=h_{ideal}[n]w[n]
%}{
%h & approximierte Impulsantwort\\
%h_{ideal} & ideale Impulsantwort\\
%w & Fensterfunktion
%}[eq:impfir]
%%
% Schätzung der Orientierung
\subsection{Schätzung der Orientierung}\label{subsec:orientierungsschätzung}
Um die Bewegung des Sensors im Koordinatensystem des Betrachters, dem \gls{g:worldframe}, darstellen zu können, muss die Orientierung des Sensors bekannt sein. Als Bezugssystem dient die Erde, bei welcher die z-Achse des Koordinatensystems parallel zur Erdbeschleunigung liegt. Zur Übersicht ist eine Darstellung der möglich auftretenden Vektoren in Abbildung \vref{img:Vektor} ersichtlich. Mit dem Gravitationsvektor $\overrightarrow{a_g}$ und der Erdbeschleunigung des Sensors $\overrightarrow{a_{grav}}$ kann mit einfachen, grundlegenden Vektoroperationen auf den Drehwinkel $\phi$ sowie auf die Rotationsachse $\overrightarrow{n}$ zwischen den beiden Vektoren geschlossen werden.\par
%
Die gemessene Erdbeschleunigung des Sensors entspricht den \gls{ac:tp}-gefilterten Beschleunigungsdaten. Mit dem Drehwinkel $\phi$ und der Rotationsachse $\overrightarrow{n}$ kann die in Abschnitt \vref{sub:rotmat} beschriebene Rotationsmatrix aufgestellt werden. Mit dieser Rotationsmatrix kann die Orientierung des Beschleunigungssensors (\gls{g:bodyframe}) in das Betrachtungssystem (\gls{g:worldframe}) transformiert werden. Der Drehwinkel $\phi$ ist der Zwischenwinkel der Vektoren $\overrightarrow{a_g}$ und $\overrightarrow{a_{grav}}$, die Rotationsachse $\overrightarrow{n}$ steht senkrecht auf diesen beiden Vektoren.
%
\image{content/3_konzept/image/Vektor_bearb}{scale=0.7}{t}[Rotation][img:Vektor]
%
\subsubsection*{Betrachtungssystem}\label{subsub:betrachter}
Um die Orientierung des Sensors zu kompensieren, ist zum Überblick in Abbildung \vref{img:koordinatensystem} das Koordinatensystem des Betrachters, das \gls{g:worldframe}, sowie das Koordinatensystem des \gls{g:myrio}, das \gls{g:bodyframe}, aufgezeigt. Das \gls{g:worldframe} liegt mit der z-Achse parallel zur Erdbeschleunigung. Bei frontaler Betrachtung von \gls{g:transversal}en Bewegungen nach recht und links resultiert eine Zu- oder Abnahme der y-Komponente. Hingegen bewirken \gls{g:sagital}e Bewegungen nach vorne und hinten eine Zu- bzw. Abnahme der x-Komponente.
%
\begin{figure}[htbp]
        \centering
        \begin{subfigure}[htbp]{0.3\textwidth}
                \includegraphics[width=\textwidth]{content/3_konzept/image/koordinatensystem_betrachter}
                \caption{Koordinatensystem des Betrachters \gls{g:worldframe}}
                \label{img:koord_betrachter}
        \end{subfigure}%
        \quad \quad
        \begin{subfigure}[htbp]{0.3\textwidth}
                \includegraphics[width=\textwidth]{content/3_konzept/image/koordinatensystem_myRIO}
                \caption{Koordinatensystem \gls{g:myrio} \gls{g:bodyframe}}
                \label{img:koord_myRIO}
        \end{subfigure}        
        \caption{Koordinatensystem}\label{img:koordinatensystem}
\end{figure}    
%
Das \gls{g:myrio} hat bekanntlich eine beliebige Ausrichtung im \gls{g:worldframe}. Durch die Montage des Beschleunigungssensors sind dessen Achsen in Bezug auf das Gehäuse gegeben und bilden somit das \gls{g:bodyframe}. Diese ist in Abbildung \vref{img:koord_myRIO} ersichtlich.
%
\subsubsection*{Drehwinkel}
Der Drehwinkel $\phi$, wie in Abbildung \vref{img:Vektor} gesehen, entspricht gerade dem Zwischenwinkel der beiden Vektoren $\overrightarrow{a\low{g}}$ sowie den \gls{ac:tp}-gefilterten Beschleunigungsdaten $\overrightarrow{a\low{grav}}$. Der Zwischenwinkel zweier Vektoren wird über das Skalarprodukt berechnet. Nach Papula \cite{lit:papula} ist dies wie in Gleichung \vref{eq:dotp} dargestellt möglich.
%
\formula{
\overrightarrow{a\low{g}}*\overrightarrow{a\low{grav}} = \mid \overrightarrow{a\low{g}}\mid *\mid \overrightarrow{a\low{grav}}\mid *\cos(\phi)\\
\\
\phi=\arccos\left(\frac{\overrightarrow{a\low{g}}*\overrightarrow{a\low{grav}}}{ \mid \overrightarrow{a\low{g}}\mid *\mid \overrightarrow{a\low{grav}}\mid}\right)
}{
\phi & Zwischenwinkel der beiden Vektoren\\
\overrightarrow{a\low{g}} & Gravitätsvektor\\
\overrightarrow{a\low{grav}} & gemessene Erdbeschleunigung
}[eq:dotp]
%
\subsubsection*{Rotationsachse}
Die Rotationsachse benötigt man, um eine Bezugsachse für die Drehung des \gls{g:bodyframe}s in das \gls{g:worldframe} vorzunehmen. Die Rotationsachse muss somit senkrecht auf dem von den beiden bekannten Vektoren stehen, dem Gravitationsvektor $\overrightarrow{a\low{g}}$ und dem vom Beschleunigungssensor aufgenommenen Vektor $\overrightarrow{a\low{grav}}$, in welchem die Erdbeschleunigung auf die verschiedenen Achsen verteilt ist. Dazu dient das Vektorprodukt, auch Kreuzprodukt genannt, als Hilfsmittel. Das Kreuzprodukt zweier Vektoren berechnet den Vektor, welcher senkrecht auf die von den beiden Vektoren aufgespannten Ebene steht. Die Länge (auch Norm oder Betrag) dieses Vektors entspricht der von den beiden Vektoren aufgespannten Fläche sowie der Länge des Vektors. Wird der erhaltene Vektor zusätzlich normiert, so hat dieser die Länge eins. Die Rotationsachse $\overrightarrow{n}$ wird wie in Gleichung \ref{eq:cross} berechnet.
%
\formula{
\overrightarrow{n} = \frac{\overrightarrow{a\low{g}} \times\overrightarrow{a\low{grav}}}{ \mid \overrightarrow{a\low{g}} \times \overrightarrow{a\low{grav}}\mid}
}{
\overrightarrow{n} & Richtung der Rotationsachse\\
\overrightarrow{a\low{g}} & Gravitätsvektor\\
\overrightarrow{a\low{grav}} & gemessene Erdbeschleunigung
}[eq:cross]
%
% Verzögerung
%\subsection{Berechnung der Bewegungsbeschleunigung} \todo{anpassen, Verzögerung erwähnen beschreiben}

%%
%Jede Filterung hat eine Verzögerung des Signals zur Folge. Diese Verzögerung verhält sich nach den Notizen in der Vorlesung Digitale Signalverarbeitung (BTE5034 DIGSV) bei Herrn Rolf Vetter wie in Gleichung \vref{eq:delay} aufgezeigt.
%%
%\formula{
%n_{d} = \frac{n_{b}}{2}
%}{
%n_{d} & Verzögerung in Samples\\
%n_{b} & Anzahl Filterkoeffizienten
%}[eq:delay]
%
% Subtraktion
%\subsubsection*{Verzögerung und Subtraktion}
%Die durch die Tiefpass-Filterung berechnete Erdbeschleunigung kann nicht direkt von der gemessenen Beschleunigung am Sensor abgezogen werden. Dies aus dem vorhin beschriebene Grund, dass jede Filterung eine Verzögerung des Signals bewirkt. Die gemessene Beschleunigung am Sensor muss also zuerst um die zuvor berechnete Anzahl Samples aufgrund der Anzahl Filterkoeffizienten verzögert werden. Dies kann man mit einem einfachen Verzögerungselement erreichen. Die Funktion eines solchen Elementes ist in Abbildung \vref{img:delay} dargestellt.\par
%%
%% Verzögerungselement
%\image{content/3_konzept/image/Verzoegerungselement}{scale=1}{htbp}[Verzögerungselement][img:delay]
%%
%Nachdem das gemessene Signal zusätzlich verzögert wurde, kann das gefilterte Signal mit der beinhaltenden Erdbeschleunigungskomponente nun vom verzögerten Signal abgezogen werden um die Beschleunigung der Bewegung zu erhalten.
%
% Hochpassfilterung
%\subsubsection*{Hochpassfilterung}
%Ein weiterer Ansatz ist, dass die gemessenen Daten mit einem Hochpass gefiltert werden. Die Beschleunigungskomponenten der Bewegung können somit von der als DC-Komponente auftretenden Erdbeschleunigung getrennt werden. Dabei ist zu beachten, dass die Filterlänge des Tiefpassfilters und des Hochpassfilters gleich lang ist. Dies aus demselben oben genannten Grund, dass jede Filterung eine Verzögerung des gefilterten Signals zur Ursache hat. Da die Erdbeschleunigung zur Kompensation der Orientierung verwendet wird und später wie im Abschnitt \vref{sub:rot} gezeigt auf die Bewegungsbeschleunigung angewendet wird muss die Verzögerung beider Signale gleich ausfallen.
%
% Rotation
\subsection{Orientierungskompensation}\label{sub:rot}
Um die Beschleunigung der Bewegung zu erhalten, können mehrere Ansätze verfolgt werden. Ein Ansatz ist, auf die gemessenen Beschleunigungsdaten zusätzlich eine Hochpassfilterung anzuwenden. Damit wird gerade das Gegenteil zur Tiefpassfilterung erreicht. Mit der Hochpassfilterung werden die Beschleunigungsdaten von der Erdbeschleunigung gekapselt. Dabei müsste jedoch die Durchlassfrequenz des Hochpasses sehr tief angelegt werden, damit auch langsame Bewegungen registriert werden. Aus diesem Grund wurde dieser Ansatz verworfen.\par 
%
In dieser Arbeit beschränken sich die Autoren nur auf die Bewegung in einer Ebene. In diesem Fall ist es ausreichend, nur eine Rotation in das Betrachtungssystem vorzunehmen. Anschliessend ist die Bewegung auf der x- und y-Achse auszuwerten. Auf der z-Achse ist nach der Rotation nur die Erdbeschleunigung vorhanden. Wird die Rotation richtig ausgeführt, so ist die Erdbeschleunigung somit von der Bewegungsbeschleunigung entkoppelt.\par
%
Die Rotation wird benötigt, um das Koordinatensystem des Sensors (\gls{g:bodyframe}) in das Koordinatensystem des Betrachters (\gls{g:worldframe}) zu transformieren. Dabei steht die zuvor berechnete Rotationsachse $\overrightarrow{n}$, um welche das System gedreht wird, sowie der ermittelte Drehwinkel $\phi$ zwischen den beiden Vektoren zur Verfügung. Die Rotationsmatrix kann mit diesen Parametern nach dem im Abschnitt \vref{sub:rotmat} beschriebenen Vorgehen aufstellt werden.\par
%
Mit der Rotationsmatrix und der berechneten Beschleunigung der Bewegung kann die Transformation vom Koordinatensystem des Sensors (\gls{g:bodyframe}) ins Koordinatensystem des Betrachters (\gls{g:worldframe}) mit einer einfachen Multiplikation erfolgen.
%
\formula{
a_{world} = a_{body} * R_{g; O; \overrightarrow{n}; \phi}
}{
a_{world} & Beschleunigung im Bezugskoordinatensystem \gls{g:worldframe}\\
R_{g; O; \overrightarrow{n}; \phi} & Rotationsmatrix um Gerade g mit Richtung $\overrightarrow{n}$ um Winkel $\phi$\\
a_{body} & Beschleunigung im Koordinatensystem des Sensors \gls{g:bodyframe} 
}[eq:delay]
%
Die Wirkung dieser Rotation ist in Abbildung \vref{img:rotation_vektor} ersichtlich. In dieser Abbildung sind die Beschleunigungsdaten des beliebig orientierten Sensors dargestellt. Zusätzlich sind die  Beschleunigungsdaten nach der Rotation ersichtlich. Da der Sensor zu diesem Zeitpunkt der Messung ruht, wirkt nur die Erdbeschleunigung. Nach der Rotation sollte also nur eine Komponente von \unit[9.81]{m/s\high{2}} auf der z-Achse vorhanden sein. Die Orientierung des Beschleunigungssensors ist kompensiert.
% 
\image{content/3_konzept/image/Rotation_Vektor}{scale=0.7}{htbp}[Rotation der Beschleunigungsdaten][img:rotation_vektor]
%
% Bewegungsdetektion
\subsection{Bewegungsdetektion}
Da die Integration einer Aufsummierung entspricht, kann durch einen kleinen Fehler in der Rotation bereits ein grosser Drift entstehen. Ein Lösungsansatz ist, eine Bewegungsdetektion einzuführen. Die Integration wird nur durchgeführt, wenn sich der Sensor auch bewegt. Ein Hilfsmittel zur Bestimmung der Variation eines Signals ist deren Varianz respektive Standardabweichung. Die Standardabweichung gibt uns Informationen über die Verteilung der Signalamplitude. Wird der Sensor in Ruhe gelassen, so ändert sich die aufgenommene Amplitude nur gering, was dem Rauschen des Sensors entspricht. Dementsprechend ist die Standardabweichung klein. Wird der Sensor bewegt, so resultiert eine grössere Änderung der Amplitude. Die Standardabweichung wird somit grösser.\par
%
Zu Beginn jeder Messung wird der Sensor für \unit[4]{s} in Ruhe gelassen. In dieser Zeit kann der Threshold mittels der Standardabweichung bestimmt werden. Da die Standardabweichung über eine verhältnismässig grosse Dauer gemessen wird, ist diese geringer als mit der Fenstermethode. Bei der Fenstermethode wird ein Fenster der Grösse \unit[200]{Samples} (\unit[0.2]{s} bei $f_a$ = \unit[1'000]{Hz}) über das Signal gefahren und in diesem Fenster die Standardabweichung bestimmt. Aus diesem Grund wird zur Berechnung des Thresholds noch zusätzlich ein Vorfaktor zur Standardabweichung multipliziert. Somit ist der Threshold grösser als die Standardabweichung des Rauschens. Dies ist sicherlich nicht eine optimale Lösung; sie könnte noch verbessert werden. Mit dieser Methode wurde jedoch eine schnelle und einfache Lösung gefunden.\par
%
\image{content/3_konzept/image/Bewegungsdetect}{scale=0.7}{t}[Bewegungsdetektion auf der y-Achse][img:bewegungdetect]
%
Die Standardabweichung wird, wie schon erwähnt, über ein Fenster $w$ der Länge \unit[200]{Smaples} berechnet. Somit erhält man die in Abbildung \vref{img:bewegungdetect} im unteren subplot dargestellte Standardabweichung. Übersteigt die Standartabweichung den zuvor definierten Threshold, so wird mit der Integration begonnen. Wird der Threshold anschliessend unterschritten, so ist keine Bewegung mehr vorhanden und es wird nicht mehr integriert. 
%
% Integration
\subsection{Berechnung der Bewegung}\label{ss:int}
%
\image{content/3_konzept/image/Integration}{scale=0.7}{h}[Bewegung auf der y-Achse][img:bewegung_y_achse]
%
Um von der Beschleunigung auf die Position zu schliessen, kann die Beschleunigung bekanntlich, nach dem Grundgesetz der Kinematik, durch zweimaliges Integrieren nach der Zeit berechnet werden. Integriert man die Beschleunigung einmal, so erhält man die Geschwindigkeit.
%
\formula{
v(t) = \int a(t)dt + v_0 
}{
v & Geschwindigkeit [$m/s$]\\
v_{0} & Anfangsgeschwindigkeit [$m/s$]\\
a & Beschleunigung [$m/s^2$]
}[eq:geschw]
%
Integriert man diese Geschwindigkeit erneut, so erhält man den zurückgelegten Weg über die betrachtete Zeitdauer.
%
\formula{
s(t) = \int v(t)dt + s_0 
}{
s & zurückgelegter Weg [m]\\
s_{0} & Anfangsposition [m]\\
v & Geschwindigkeit [$m/s$]
}[eq:weg]
% 
Die Integration erfolgt, wie bereits im Abschnitt \vref{sec:numint} beschrieben, mittels der Trapezmethode. Speziell dabei ist, dass dafür ein \gls{ac:iir}-Filter angewendet wird. Dazu wird die in Abschnitt \vref{subsub:filterentwurf} beschriebene Bilineare-Transformation verwendet.\par
%
Aus der Regelungstechnik ist bekannt, dass die Übertragungsfunktion eines Integrators $H(s) = \frac{1}{s}$ entspricht. Dies ist die Übertragungsform eines Analogfilters, also einem zeitkontinuierlichen \gls{g:lti}-System. Um auf die Übertragungsfunktion des Digitalfilters zu gelangen, kann nun die Bilineare-Transformation angewendet werden. Wie in Gleichung \vref{eq:bilinear_trans} gezeigt.
%
\formula{
H(s) &= \frac{1}{s}\\[1ex]
H(z) &= H(s)\mid _{s = \frac{2}{T_a}*\frac{1-z^{-1}}{1+z^{-1}}}
}{
}[eq:trans_filter]
%
Aus dieser Transformation lässt sich die Übertragungsfunktion des Digitalfilters berechnen.
%
\formula{
H(z) &= \frac{T_a}{2}*\frac{1+z^{-1}}{1-z^{-1}}
}{
}[eq:int_filter]
% 
Wird die Gleichung \vref{eq:int_filter} ausmultipliziert, so erhält man die in Gleichung \vref{eq:iir_Filter} definierten Filterkoeffizienten, womit das Digitalfilter festgelegt ist.
%
\formula{
a_0 &= 1\\[1ex]
a_1 &= -1\\[1ex]
b_0 &= \frac{T_a}{2}\\[1ex]
b_1 &= \frac{T_a}{2}
}{
}[eq:koeff_filter]
%
Diese Filterkoeffizienten werden wie in Abschnitt \vref{subsub:filterentwurf} gesehen mit dem Befehl \texttt{filter} in \gls{g:matlab} auf die Beschleunigungsdaten angewandt. Der Output ist bei erster Anwendung die Geschwindigkeit und bei zweiter Anwendung der zurückgelegte Weg. 
%Software
\section{LabVIEW Rohdaten aufzeichnen}\label{s:konzept:sw}
		Für die Verifikation des Konzepts müssen Rohdaten des Beschleunigungssensors aufgenommen und in \gls{g:matlab} eingespeist werden. Dazu muss eine \gls{g:labview}-\acrshort{ac:vi} erstellt werden, die Daten aufnehmen und in einem \gls{g:matlab}-kompatiblen Format speichern kann. Die fertigen Projektdaten \texttt{concept\_reametric} sind im Anhang \vref{s:anhang_labview} zu finden.\par 
		%
		Als Basis für die \acrshort{ac:vi} dient das Standardprojekt \textsf{myRIO Project}\footnote{Das Projekt kann im Startdialog von \gls{g:labview} 2013 angewählt werden.} von \gls{g:labview}, das folgende Möglichkeiten mitbringt:
		%
		\begin{itemize}
			\item Anbindung, inkl. Initialisierung den \gls{g:myrio}s
			\item Darstellung von aktuellen Beschleunigungsdaten in Diagramm
			\item Start und Stopp der Messung
		\end{itemize}
		%
		Damit die dargestellten Daten aufgezeichnet werden können, muss das bestehende Projekt mit den Komponenten \textsf{Datei anlegen}, \textsf{Daten buffern} und \textsf{Daten speichern} ergänzt werden. Für diesen Zweck werden die drei Zustände der bestehenden Sequenz angepasst.
		%
		\subsubsection*{Initialisierungs-Zustand}
			In der Initialisierung muss eine Datei für das spätere Speichern der Rohdaten erstellt werden. Dazu wird der in Abbildung \vref{img:init_file} ersichtliche Ablauf verwendet. Der Dateiname kann mithilfe eines Eingabefeldes (siehe Abbildung \vref{img:init_file_indicator}) individuell angepasst werden, muss aber die Endung \texttt{*.xlsx} aufweisen. Der Pfad der angelegten Datei bezieht sich auf das Home-Directory des \texttt{lvuser}, einem lokalen Benutzer des \gls{ac:ni} Real-Time-Linux. Der endgültige Speicherpfad wird anschliessend im letzten Zustand (Schliessen-Zustand) ausgegeben.
			%
			\begin{figure}[htbp] %htbp
				\centering
				\begin{subfigure}[b]{0.49\textwidth}
					\centering
					\includegraphics[scale=1]{content/3_konzept/image/init_file}  
					\caption{Blockdiagramm}
					\label{img:init_file}          
				\end{subfigure}
				\begin{subfigure}[b]{0.49\textwidth}
					\centering
					\includegraphics[scale=1]{content/3_konzept/image/init_file_indicator}  
					\caption{Frontpanel} 
					\label{img:init_file_indicator}         
				\end{subfigure}
				\caption{Datei erstellen}
				\label{img:datei_erstellen}
	    	\end{figure}\par
	    	%
	    	Für das einfachere Einstellen der Sampling-Rate wird die Initialisierung noch durch eine solche Möglichkeit ergänzt. Für eine einfachere Interpretation wird zudem noch eine Umrechnung in Herz vorgenommen und angezeigt. Der Ablauf und das UI ist in der Abbildung \vref{img:periode} ersichtlich.
	    	%
			\begin{figure}[htbp] %htbp
				\centering
				\begin{subfigure}[b]{0.49\textwidth}
					\centering
					\includegraphics[scale=1]{content/3_konzept/image/init_periode}  
					\caption{Blockdiagramm}
					\label{img:init_periode}          
				\end{subfigure}
				\begin{subfigure}[b]{0.49\textwidth}
					\centering
					\includegraphics[scale=1]{content/3_konzept/image/init_periode_indicator}  
					\caption{Frontpanel} 
					\label{img:init_periode_indicator}         
				\end{subfigure}
				\caption{Sampling-Rate einstellen}
				\label{img:periode}
	    	\end{figure}
	    	%	
		%
		\subsubsection*{Daten-Aufzeichnen und -Verarbeiten-Zustand}
			Der Hauptzustand dieses \gls{ac:vi} besteht aus zwei Teilen. Der erste Teil beinhaltet eine Endlosschlaufe\footnote{Genauer ein Time Loop, der eine genaue zyklische Ausführung gewährleistet.}, die zyklisch Beschleunigungsdaten und Timestamps einliest und buffert. Zusätzlich werden die aktuellen Daten im Diagramm auf dem Frontpanel ausgegeben. Wird die Endlosschleife durch einen Fehler oder durch Betätigung der Stopp-Schaltfläche beendet, so werden im zweiten Teil die gebufferten Daten mit Labels versehen, zu einer N x 4 Matrix zusammengefasst und in eine Excel-Tabelle geschrieben. Dargestellt ist dieser Ablauf in der Abbildung \vref{img:process_2}. Die für die Bedienung erforderlichen Komponenten können der Abbildung \vref{img:process_indicator} entnommen werden.
			%
			\begin{figure}[htbp] %htbp
				\centering
				\begin{subfigure}[b]{\textwidth}
					\centering
					\includegraphics[scale=0.4]{content/3_konzept/image/process}  
					\caption{Blockdiagramm}
					\label{img:process_2}          
				\end{subfigure}
				\begin{subfigure}[b]{\textwidth}
					\centering
					\includegraphics[scale=0.7]{content/3_konzept/image/process_indicator}  
					\caption{Frontpanel} 
					\label{img:process_indicator}         
				\end{subfigure}
				\caption{Daten einlesen und speichern}
				\label{img:daten_einlesen}
	    	\end{figure}
	    	%	
		%
		\subsubsection*{Schliessen-Zustand}
			Abgeschlossen wird das \gls{ac:vi} durch den Schliessen-Zustand. Dabei wird das \gls{g:myrio} auf den Ursprung zurückgesetzt und der Speicherpfad der Daten ausgegeben. Für diesen Zweck wird eine vorgefertigte \gls{ac:vi} von \gls{ac:ni} verwendet, die das Reseten des \gls{g:myrio} durchführt. Die Ausgabe des Pfades erfolgt bereits im vorderen Zustand, wird jedoch erst hier visualisiert. Für das Blockdiagramm und das UI sei auf die Abbildung \vref{img:speicherpfad} verwiesen.
			%
			\begin{figure}[htbp] %htbp
				\centering
				\begin{subfigure}[b]{0.49\textwidth}
					\centering
					\includegraphics[scale=1]{content/3_konzept/image/close}  
					\caption{Blockdiagramm}
					\label{img:process}          
				\end{subfigure}
				\begin{subfigure}[b]{0.49\textwidth}
					\centering
					\includegraphics[scale=1]{content/3_konzept/image/close_indicator}  
					\caption{Frontpanel} 
					\label{img:close_indicator}         
				\end{subfigure}
				\caption{Speicherpfad angeben und \gls{g:myrio} reseten}
				\label{img:speicherpfad}
	    	\end{figure}\par
	    	%	
	%
	%\subsection{myRIO Posture Estimation}\label{subsec:myposture} \todo{gut darauf eingehen}
%
%
%Verifikation Rotation
\section{Verifikation Schätzung Rotationswinkel und Rotation}\label{s:verifikation_rotation}
	%
	%
	\subsection{Grund/Zweck der Messung}
		Die Schätzung des Rotationswinkels ist der erste Teil des Konzepts\footnote{siehe Abschnitt \vref{s:blockdiagramm}.} und das erste von drei Experimental-Protokollen\footnote{Die übrigen Protokolle sind in den Abschnitten \vref{s:verifikation_translation} und \vref{s:verifikation_transaltion_rotation} zu finden. Sie dienen als Ausgangslage für die Validierung des Konzepts.}. Sie dient als Basis für die spätere Rotation und anschliessende doppelte Integration und ist Voraussetzung für eine korrekte Messung. Die Winkel werden dabei hinsichtlich des Bezugssystems bestimmt. Das Protokoll soll die Genauigkeit des Algorithmus bestimmen und abwägen, ob sie den Anforderungen der Hypothese \vref{hypo:rotation} genügt.
		%
		\begin{hypo}\label{hypo:rotation}	   
			Der eingestellte Winkel wird durch die Schätzung richtig bestimmt.	
			Nach einer einmaligen Rotation haben die Komponenten x und y den Wert \unitfrac[0.0]{m}{s\high{2}} und die z-Komponente \unitfrac[9.81]{m}{s\high{2}}. Die Abweichung ist dabei nicht grösser als \unitfrac[0.01]{m}{s\high{2}}.
		\end{hypo}
	%
	%
	\subsection{Material/Testumgebung}
		Die Messung, respektive Schätzung der Rotationswinkel erfolgt statisch auf einer eigens für dieses Projekt entworfenen Testumgebung, die später zur Simulation eines Bewegungsablaufs des Knies gebraucht wird. Siehe dazu den Abschnitt \vref{ss:testumgebung_tran_rot}, in welchem auch näher auf die Möglichkeiten des Aufbaus eingegangen wird. Für dieses Protokoll wird lediglich von der Tatsache Gebrauch gemacht, dass das \gls{g:myrio} kontrolliert in verschiedene Positionen gebracht und somit eine Reproduzierbarkeit der Messung gewährleistet werden kann.\par
		%
		Für die Messung wird die Befestigung und der Bewegungsfreiraum des Testaufbaus so eingestellt, dass ein möglichst grosser Winkelbereich zur Verfügung steht (insgesamt \unit[56]{°})\footnote{Die Markierung \textsf{R} auf dem Schwenkarm.}. Dazu wird der Rotationsarm sowie die Querverbindung, wie in Abbildung  \vref{img:messaufbau_rot} gezeigt, angeordnet. Die Position des \gls{g:myrio} M\low{1}, das für die Aufzeichnung der Beschleunigungsdaten eingesetzt wird, befindet sich am äussersten Ende des Schwenkarms.\par
		%
		\image{content/3_konzept/image/aufbau_rot}{scale=1}{htbp}[Testaufbau Rotation][img:messaufbau_rot]	
		%
		Die absolute Messung des eingestellten Winkels erfolgt über den Winkelmesser M\low{2}, der direkt am Schwenkarm befestigt ist (siehe Abbildung \vref{img:messaufbau_tran_rot}). Alle verwendeten Messmittel sind in der Tabelle \vref{tab:messmittel_rot} aufgeführt und mit einer geschätzten Messgenauigkeit versehen.
		%
		\input{content/3_konzept/table/messmittel_rot}
	%
	%
	\subsection{Methoden}
		%
		\subsubsection*{Messgruppen}
			Für die Messung werden zwei Messgruppen festgelegt. Die eine fungieren als Testgruppe, wogegen die andere der Kontrolle dient.
			%
			\begin{itemize}
				%
				\item \textbf{Testgruppe} In der Testgruppe werden Beschleunigungsdaten durch das \gls{g:myrio} M\low{1} aufgezeichnet\footnote{siehe Abschnitt \vref{s:konzept:sw}} und gespeichert. Im Anschluss an die Messung werden die Daten in \gls{g:matlab} eingelesen und verarbeitet.
				%
				\item \textbf{Kontrollgruppe} Die zweite Gruppe repräsentiert die direkte Messung mithilfe des Winkelmessers M\low{2}. Sie dient gleichzeitig der Kontrolle für die folgende Interpretation.
			\end{itemize}
			%
			Die unabhängige Variable dieser Gruppen stellt die Messmethodik dar. 
		%
		\subsubsection*{Testgruppe Messmethodik}
			Die Messmethodik der Testgruppe basiert zum einen auf den aufgezeichneten Beschleunigungsdaten und zum anderen aus mathematischen Operationen\footnote{Siehe Abschnitt \vref{s:blockdiagramm} für den verwendeten Algorithmus.}, die die Winkelschätzung vornehmen. Zur Auswertung der Rotation dient das \gls{g:matlab}-Skript \texttt{Check\_Rotation\_final.m}, das im Anhang \vref{s:anhang_matlab} zu finden ist und auf dem ersten Teil des Konzepts aufbaut. Im Konzept wird aus den im Ruhezustand aufgenommenen Beschleunigungsdaten die Rotationsmatrix berechnet. Mit dieser Rotationsmatrix gelingt die Transformation des \gls{g:bodyframe} in das \gls{g:worldframe}. Aus der aufgestellten Rotationsmatrix kann nach \cite{lit:craig} der pitch-Winkel, wie in Gleichung \vref{eq:pitch} gezeigt, berechnet werden. 
%
			\formula{
			M_{rot} &=\begin{bmatrix}a & b & c \\ d & e & f \\ g & h & i \end{bmatrix} \\[1ex]
			pitch &= atan2(-g,\sqrt{a^2 + d^2})
			}{
			M_{rot} & Rotationsmatrix\\
			pitch & Nick-Winkel
			}[eq:pitch]
%			
			Dieser pitch-Winkel entspricht gerade im Falle des in zuvor beschriebenem Testaufbau dem Nick-Winkel um welchen das \gls{g:myrio} um die im Abschnitt \vref{subsub:betrachter} definierte x-Achse gedreht wird. Somit wird der Winkel der Testgruppe aus der aufgestellten Rotationsmatrix aus dem Konzept berechnet.
		%
		\subsubsection*{Kontrollgruppe Messmethodik}
			Der Winkel der Kontrollgruppe wird direkt mit dem Winkelmesser M\low{2} gemessen. Zu beachten ist, dass dessen Winkelskala in \unit[90]{°}-Bereiche unterteilt ist und deshalb ein grösserer Winkel durch Addition ermittelt werden muss. Als Referenz für die Auslenkung dient dabei die in Abbildung \vref{img:messaufbau_rot} ersichtliche \unit[0]{°}-Linie. Gemessen wird gegen den Uhrzeigersinn.
		%
		\subsubsection*{Testbeschreibungen}
			Es werden Messungen mit unterschiedlichen Rotationswinkeln durchgeführt. Dazu wird der Testaufbau manuell in die gewünschte Ausrichtung gebracht. Es wird zwischen fünf verschiedenen Winkeln unterschieden, wie die Abbildung \vref{img:rot_winkeln} zeigt. Die Endwinkel (\unit[62]{°} und \unit[118]{°}) sind durch die mechanischen Einschränkungen bestimmt und stellen die maximale Auslenkung dar. Die Zwischenwinkel sind so gewählt, dass möglichst gleichmässig der gesamte Bereich abgedeckt wird.\par
			%
			\image{content/3_konzept/image/rot_winkeln}{scale=0.4}{htbp}[Rotation-Winkel][img:rot_winkeln]
			%
			Der Messablauf sieht folgende Schritte vor. Sie werden jeweils bei jedem Winkel wiederholt.
			\begin{enumerate}
				\item Testaufbau auf den gewünschten Winkel einstellen. Dazu den Winkelmesser M\low{2} verwenden
				\item \gls{g:labview}-Programm starten. Es müssen während \unit[6.0]{s} Daten aufgezeichnet werden\footnote{Die definierte minimale Messdauer, vorgeben durch das Konzept.}
				\item Den vorherigen Schritt 5-mal wiederholen
				\item Datenextraktion nach mit den in Abschnitt \vref{ss:myRIO_hw} beschriebenen Methoden
				\item Daten mit \gls{g:matlab} verarbeiten und auswerten
			\end{enumerate}	
		%
		\subsubsection*{Datenauswertung}
			Es gilt die Winkelschätzung hinsichtlich des eingestellten Winkels auszuwerten. Weiter muss die Rotation geprüft werden. Das Messergebnis der beiden Messgruppen stellt die abhängige Variable dar.\par 
			%
			Die absolute Messabweichung, gemittelt\footnote{Es wird der arithmetische Mittelwert verwendet.} über die fünf Messungen,  beträgt bei den unterschiedlichen Winkeln \unit[-2.28]{°} (\unit[62]{°}), \unit[-1.65]{°} (\unit[77]{°}), \unit[-1.45]{°} (\unit[90]{°}), \unit[-0.22]{°} (\unit[105]{°}) und \unit[+0.74]{°} (\unit[118]{°}). Dies entspricht den relativen Fehlern von \unit[-0.038]{\%} (\unit[62]{°}), \unit[-0.021]{\%} (\unit[77]{°}), \unit[-0.016]{\%} (\unit[90]{°}), \unit[-0.002]{\%} (\unit[105]{°}) und \unit[+0.006]{\%} (\unit[118]{°}).\par
			%
			Analysiert man die Messungen hinsichtlich ihrer Standardabweichung und des Mittelwerts, so ergibt dies bei \unit[62]{°} den Mittelwert \unit[59.72]{°} und die Standardabweichung \unit[0.009]{°}. Für die übrigen Winkel sind es \unit[75.35]{°}, \unit[88.55]{°}, \unit[104.78]{°} und \unit[118.74]{°} (Winkel \unit[77]{°}, \unit[90]{°}, \unit[105]{°} und \unit[118]{°}, in dieser Reihenfolge) für den Mittelwert und \unit[0.005]{°}, \unit[0.009]{°}, \unit[0.003]{°} und \unit[0.152]{°} für die Standardabweichung.\par 
			%
			Der Rotationswinkel kann zwar für eine Aussage über die Rotation verwendet werden, seine Bedeutung ist jedoch nur zweitrangig, wenn die Rotation an sich nicht funktioniert. Daher gilt es, die Beschleunigungskomponenten der einzelnen Achsen nach der Rotation auszuwerten. Bei allen Messungen ist der Beschleunigungsvektor $\overrightarrow{a_{grav}}=[0\quad 0\quad 1]^{\top}$, was dem unbewegten \gls{g:worldframe} entspricht (auf der z-Achse die Erdbeschleunigung).
			%
			Die Auswertung der Messungen ist in der Tabelle \vref{tab:auswertung_tran} zusammengefasst. 
			%
			\input{content/3_konzept/table/auswertung_rot} 
			
	%
	%
	\subsection{Interpretation}\label{ss:rot}
		Bei allen Winkelmessungen der Testgruppe sind Abweichungen aufgetreten. Diese bewegen sich mit maximal \unit[2.28]{°} im Rahmen der geschätzten Genauigkeit. Es ist dabei zu berücksichtigen, dass die absolute Winkelmessung mit dem Winkelmesser M\low{2} eine relative hohe Ungenauigkeit von $\pm$\unit[1]{°} aufweist. Es könnte darum durchaus im Bereich des Möglichen liegen, dass die Kontrollgruppe hier die grösseren Abweichungen von der Wirklichkeit aufweist als die Testgruppe. Die Messungen an sich weisen eine hohe Konstanz auf, was sich in den geringen Standardabweichungen widerspiegelt. Über den Erwartungen sind die Ergebnisse hinsichtlich der Rotation. Bei jeder Auslenkung konnte das \gls{g:bodyframe} erfolgreich und mit keinerlei Abweichung in das \gls{g:worldframe} rotiert werden.\par
		%
		In Anbetracht der Auswertung kann damit die Hypothese \vref{hypo:rotation} vollumfänglich bestätigt werden. Mit dem Erfüllen des ersten Protokolls ist zugleich das Fundament für die folgenden Bestandteile des Konzepts gelegt.
%
%
%Verifikation Translation
\section{Verifikation Translation}\label{s:verifikation_translation}
	%
	%
	\subsection{Grund/Zweck der Messung}
		Die Verifikation der Translation stellt das zweite Experimental-Protokoll dar. Ziel der Messung ist es, den kompletten Algorithmus hinsichtlich einer linearen Translation zu überprüfen. Dabei gilt es, relevante Fakten wie Genauigkeit und Dynamik zu extrahieren und für die Validierung festzuhalten. Die in der Hypothese \vref{hypo:translation} festgelegten Anforderungen müssen erfüllt werden.
		%
		\begin{hypo}\label{hypo:translation}	    	
			Nach einer linearen Translation um die Distanz \unit[5.0]{cm} ist das Ergebnis des Algorithmus dieselbe. Die Abweichung ist dabei maximal $\pm$\unit[1.0]{cm}\footnote{Die Messgenauigkeit ist im Abschnitt \vref{ss:messgenauigkeit} erläutert.}. Die Position des \gls{g:myrio} hat keinen Einfluss auf das Messergebnis.
		\end{hypo}
	%
	%
	\subsection{Material/Testumgebung}\label{ss:material_translation}
		Die Messung muss reproduzierbar sein. Deshalb muss eine Testumgebung gewährleistet sein, die für eine Simulation einer geradlinigen Translation geeignet ist. Diese Voraussetzung erfüllt der Kreuztisch einer Standbohr-/Fräsmaschine oder der Werkzeugschlitten einer Drehbank. Damit können vorgegebene Pfade präzise in der x-y-Ebene gefahren werden.\par 
		%
		Für die Messung wird der Werkzeugschlitten der Schaublin-Villeneuve M\low{3} aus der mechanischen Abteilung verwendet (siehe Abbildung \vref{img:drehbank}). Dieser erlaubt es, eine kontrollierte Translation in der y-Richtung vorzunehmen. Weiter kommt als zentrale Komponente das \gls{g:myrio} M\low{1} zum Einsatz. Es dient der Aufzeichnung der Beschleunigungsdaten. Die gefahrene Distanz wird mit Hilfe des Massstabs M\low{3} angezeichnet\footnote{Der genau Vorschub kann der Bewegungsanforderung hinsichtlich der Geschwindigkeit nicht gerecht werden.} (Abbildung \vref{img:distanz}).\par
		%
		\begin{figure}[t]
			\centering
			\begin{subfigure}[htbp]{0.7\textwidth}
			      \includegraphics[height=3.5cm]{content/3_konzept/image/testaufbau_translation}
			      \caption{Drehbank}
			      \label{img:drehbank}
			      \vspace*{1.5ex}
			\end{subfigure}
			%
			\begin{subfigure}[htbp]{0.32\textwidth}
			      \includegraphics[height=3.5cm]{content/3_konzept/image/testaufbau_tran_distanz}
			      \caption{Translations-Distanz}
			      \label{img:distanz}
			\end{subfigure}        
			\caption{Testaufbau Translation}
			\label{img:messaufbau_tran}
		\end{figure}    
		%
		Die Translation wird durch das Drehen des Drehrads ausgelöst. Die zurückgelegte Distanz wird dabei optisch durch den Bediener überprüft (absolute Messung). Ein Setzen von mechanischen Anschlägen würde das Messergebnis negativ beeinflussen, weshalb darauf verzichtet wird. Es wird zwischen zwei Translationsgeschwindigkeiten unterschieden, wobei die Geschwindigkeit durch die Bewegungszeit, gemessen mit der Stoppuhr M\low{4}, klassifiziert wird.\par
		%
		Das \gls{g:myrio} wird für die Messungen in unterschiedlichen Positionen am Werkzeugtisch angebracht. Zur Befestigung dient ein Spannblock. Alle zum Einsatz kommenden Messmittel dieses Protokolls sind in der Tabelle \vref{tab:messmittel_translation} aufgelistet. Zudem ist eine geschätzte Genauigkeit angegeben, die jedoch hinsichtlich der manuell durchgeführten Translation vernachlässigbar ist.
		%
		\input{content/3_konzept/table/messmittel}
	%
	%
	\subsection{Methoden}
		%
		\subsubsection*{Messgruppen}
			Es werden zwei Messgruppen definiert. Die eine dient als Testgruppe und die andere als Kontrollgruppe. 
			%
			\begin{itemize}
				%
				\item \textbf{Testgruppe} Die Testgruppe repräsentiert das \gls{g:myrio} M\low{1}, das zur Aufzeichnung der Beschleunigungsdaten benötigt wird. Dabei werden die Daten nur gespeichert und nicht verarbeitet\footnote{Für detailliertere Informationen zur Aufzeichnung sei auf den Abschnitt \vref{s:konzept:sw} verwiesen.}. Die Signalverarbeitung erfolgt zu einem späteren Zeitpunkt auf einem Computer mit Hilfe von \gls{g:matlab}.
				%
				\item \textbf{Kontrollgruppe} Die zweite Gruppe stellt die direkte Messung mit dem Werkzeugtisch dar. Sie ist gleichzeitig die Kontrollgruppe, die schliesslich bei der Interpretation als Ausgangslage gilt.
			\end{itemize}
			%
			Die Messmethodik stellt bei den beschriebenen Gruppen die unabhängige Variable dar.
		%
		\subsubsection*{Testgruppe Messmethodik}\label{ss:messmethodik_kontroll_tran}
			Die Translation wird indirekt durch die auftretenden Beschleunigungen gemessen. Dazu werden die aufgezeichneten Daten in das \gls{g:matlab}-Skript \texttt{Check\_Translation\_final.m} eingelesen, wo mithilfe von mathematischen Operationen die Distanz bestimmt wird. Das Skript ist im Anhang \vref{s:anhang_matlab} zu finden.
		%
		\subsubsection*{Kontrollgruppe Messmethodik}
			Die Aufnahme der Pfadlänge erfolgt direkt mit dem Massstab M\low{2}. Die vorgegebene Distanz von \unit[5.0]{cm} wird dabei auf dem Schlitten der Drehbank M\low{3} vermerkt.
		%
		\subsubsection*{Testbeschreibungen}
			Es werden mehrere unterschiedliche Messungen, die sich hinsichtlich Geschwindigkeit und Positionierung unterscheiden, durchgeführt. Dazu wird das \gls{g:myrio} M\low{1} unterschiedlich positioniert. Um die Anzahl Messungen in einem überschaubaren Rahmen zu halten, wird der Test auf 3 Positionen beschränkt. 
			%
			\begin{itemize}
				\item \textbf{x-Achse Position} Das \gls{g:myrio} M\low{1} wird flach auf dem Kreuztisch angebracht. Dabei zeigt die x-Achse des Beschleunigungssensors nach unten, sprich gleichgerichtet wie der Gravitationsvektor. Relative Beschleunigungen erfolgen in der x-y-Ebene in y-Richtung des Werkzeugtisches. Dies entspricht ebenfalls der y-Richtung (negativ) im \gls{g:worldframe}, siehe Abbildung \vref{img:koord_betrachter}. Eine schematische und reale Darstellung der Befestigung kann den Abbildungen \vref{img:x_achse} entnommen werden.
				%
				\begin{figure}[htbp]
					\centering
					\begin{subfigure}[htbp]{0.49\textwidth}
						\centering
					     \includegraphics[height=3.7cm]{content/3_konzept/image/testaufbau_translation_position_x}
					     \caption{schematisch}
					     \label{img:x_schematisch}
					\end{subfigure}%
					\begin{subfigure}[htbp]{0.49\textwidth}
						\centering
					     \includegraphics[height=3.7cm]{content/3_konzept/image/testaufbau_translation_position_x_real}
					     \caption{real}
					     \label{img:x_real}
					\end{subfigure}        
					\caption{x-Achsen Position}
					\label{img:x_achse}
				\end{figure}    
				%
				\item \textbf{y-Achse Position} Bei der zweiten Position wird das \gls{g:myrio} so angebracht, dass die y-Achse des Beschleunigungssensors parallel zum Gravitationsvektor steht. Gemessene Beschleunigungen wirken sich somit nur auf die x- und z-Achse aus. Die Abbildung \vref{img:y_achse} verdeutlicht diesen Aufbau. Die Translation wird in der y-Achse (positiv) erfolgen, bezogen auf das \gls{g:worldframe}.
				\begin{figure}[htbp]
					\centering
					\begin{subfigure}[htbp]{0.49\textwidth}
						\centering
						\includegraphics[height=3.7cm]{content/3_konzept/image/testaufbau_translation_position_y}
						\caption{schematisch}
						\label{img:y_schematisch}
					\end{subfigure}%
					\begin{subfigure}[htbp]{0.49\textwidth}
						\centering
						\includegraphics[height=3.7cm]{content/3_konzept/image/testaufbau_translation_position_y_real}
						\caption{real}
						\label{img:y_real}
					\end{subfigure}        
					\caption{y-Achsen Position}
					\label{img:y_achse}
				\end{figure}    
				%
				\item \textbf{z-Achse Position} Abschliessend erfolgt noch eine Positionierung mit der z-Achse des Beschleunigungssensors in Richtung des Gravitationsvektors (gleichgerichtet). Aus dieser Konstellation ergeben sich nur Beschleunigungen auf die x- und y-Achsen des Sensors, was eine negative Translation in negativer y-Richtung, bezogen auf das \gls{g:worldframe}, zur Folge hat. Die Befestigungseinrichtung des \gls{g:myrio}s M\low{1} ist in der Abbildung \vref{img:z_achse} zu sehen.
				\begin{figure}[htbp]
					\centering
					\begin{subfigure}[htbp]{0.49\textwidth}
						\centering
						\includegraphics[height=3.7cm]{content/3_konzept/image/testaufbau_translation_position_z}
						\caption{schematisch}
						\label{img:z_schematisch}
					\end{subfigure}%
					\begin{subfigure}[htbp]{0.49\textwidth}
						\centering
						\includegraphics[height=3.7cm]{content/3_konzept/image/testaufbau_translation_position_z_real}
						\caption{real}
						\label{img:z_real}
					\end{subfigure}        
					\caption{z-Achsen Position}
					\label{img:z_achse}
				\end{figure}    
			\end{itemize}\par 
			%
			Die zu fahrende Distanz wird auf \unit[5.0]{cm} festgelegt. Dies entspricht dem  Messbereich, der in Abschnitt \vref{ss:messbereich} erläutert ist. Bedingt durch die manuelle Durchführung der Translation, kann eine Toleranz des zurückgelegten Pfades vorliegen. Diese ist innerhalb von $\pm$\unit[1.0]{cm} zu halten.\par
			%
			Wie im vorherigen Abschnitt \vref{ss:material_translation} erörtert, wird die Geschwindigkeit indirekt über die Bewegungszeit gemessen. Daher werden lediglich zwei Bereiche definiert:
			\begin{itemize}
				\item \textbf{langsam} Die Translation dauert \unit[2.0]{s}. Diese Vorgabe wird nur rudimentär mit einer Zeitmessung verifiziert (Stoppuhr M\low{4}).  
				%
				\item \textbf{schnell} Eine Bewegungszeit von \unit[1.0]{s}.
			\end{itemize}\par
			%
			Insgesamt ergeben sich durch die verschiedenen Positionierungen und Geschwindigkeiten \\6 verschiedene Messungen. Der Messablauf gliedert sich in 5 Schritte. Alle Schritte sind bei jeder Positionierung und Geschwindigkeit 15-mal zu wiederholen. 
			%
			\begin{enumerate}
				\item Das \gls{g:myrio} M\low{1} wie vorgegeben positionieren
				\item Den Werkzeugtisch an die markierte Startposition bewegen
				\item Das \gls{g:labview}-Programm starten
				\item Messung starten
					\begin{enumerate}
						\item \unit[4.0]{s} warten, bis die Rotationswinkel geschätzt sind
						\item Translation durchführen (\unit[5.0]{cm}, \textsf{langsam} oder \textsf{schnell})
						\item Warten bis \unit[10.0]{s} verstrichen sind (totale Messzeit)
					\end{enumerate}
				\item Werkzeugtisch in Ursprungsposition bewegen
			\end{enumerate}
		%
		\subsubsection*{Datenauswertung}
			Die relativ gemessene Distanz der Testgruppe muss bezogen auf die Kontrollgruppe ausgewertet werden. Die ermittelte Entfernung ist dabei die abhängige Variable dieses Protokolls. Die Messresultate werden hinsichtlich der Messabweichung und ihrer Standardabweichung untersucht. Für die Auswertung irrelevanter Diagramme sei auf den Anhang \vref{ss:anhang_konzept_messung_translation} verwiesen.
			%
			\begin{itemize}
			%\paragraph*{x-Achsen Position}
				\item \textbf{x-Achsen Position} Bei über 15 Messungen mit der langsamen Geschwindigkeit tritt ein mittlerer absoluter Fehler von \unit[0.341]{cm} auf, was \unit[6.8]{\%} ergibt. Die gemessenen Translationen, zu sehen in der Abbildung \vref{img:x_tran_langsam_y}, weisen eine mittlere Distanz von \unit[-4.659]{cm} (blaue Linie) mit einer Standardabweichung (rote Linien) von \unit[0.348]{cm} auf.
				\image{content/3_konzept/image/mittel_5_X_Y}{scale=0.6}{htbp}[x-Position Translation \textsf{langsam}][img:x_tran_langsam_y]
				%
				Wird die Geschwindigkeit auf Stufe \textsf{schnell} verdoppelt, so verkleinert sich der mittlere absolute Fehler auf \unit[0.192]{cm}. Dies entspricht einer relativen Abweichung von \unit[3.8]{\%}. Daraus ergibt sich eine mittlere gemessene Distanz von \unit[-4.808]{cm} mit einer Standardabweichung von \unit[0.349]{cm}. Ersichtlich sind die Messung und die Auswertung in der Abbildung \vref{img:x_tran_schnell_y}.
				%
				\image{content/3_konzept/image/mittel_5_X_Y}{scale=0.6}{htbp}[x-Position Translation \textsf{schnell}][img:x_tran_schnell_y] 
			%
			%\paragraph*{y-Achsen Position}
				\item \textbf{y-Achsen Position} Befindet sich das \gls{g:myrio} in der y-Achsen Position, so ergibt sich über 15 Messungen ein mittlerer absoluter Fehler von \unit[2.203]{cm} (relativ \unit[44.1]{\%}). Dies bei der Geschwindigkeit \textsf{langsam}. Die Analyse hinsichtlich des gemessenen Mittelwerts und Standardabweichung ergibt \unit[7.203]{cm} und \unit[0.467]{cm}. Die Abbildung \vref{img:y_tran_langsam_y} zeigt die 15 Messungen mit eingezeichneten Kenngrössen (blau Mittelwert der Messung und rot die Standardabweichung).
				%
				\image{content/3_konzept/image/mittel_5_Y_Y}{scale=0.6}{htbp}[y-Position Translation \textsf{langsam}][img:y_tran_langsam_y]
				%
				Eine Erhöhung der Geschwindigkeit bringt einen mittleren absoluten Messfehler von \unit[1.343]{cm} und einen relativen von \unit[26.8]{\%} zutage. Dies bei einem Mittelwert von \unit[6.343]{cm} und einer Standardabweichung von \unit[0.558]{cm}; siehe Abbildung \vref{img:y_tran_schnell_y}.
				%
				\image{content/3_konzept/image/schnell_5_Y_Y}{scale=0.6}{htbp}[y-Position Translation \textsf{schnell}][img:y_tran_schnell_y]
			%
			%\paragraph*{z-Achsen Position}
				\item \textbf{z-Achsen Position} Die abschliessende Messung in der z-Achsen Position ergibt bei der \textsf{langsamen} Geschwindigkeit einen absoluten mittleren Fehler von \unit[2.203]{cm}, was einem relativen Fehler von \unit[44.1]{\%} entspricht. Betrachtet man die Abbildung \vref{img:z_tran_langsam_y}, so zeigt sich bei der blauen Linie ein Mittelwert von \unit[-2.797]{cm} bei einer Standardabweichung von \unit[0.364]{cm}.
				%
				\image{content/3_konzept/image/mittel_5_Z_Y}{scale=0.6}{htbp}[z-Position Translation y-Richtung \textsf{langsam}][img:z_tran_langsam_y]
				%
				Bei der Geschwindigkeit \textsf{schnell} verringert sich der absolute Fehler auf \unit[0.709]{cm} (entspricht relativ \unit[14.1]{\%}). Die Messung an sich hat einen Mittelwert von \unit[-4.294]{cm} bei einer Standardabweichung von \unit[0.231]{cm}. Die Abbildung \vref{img:z_tran_schnell_y} zeigt das gemessene Ergebnis.\par 
				%
				\image{content/3_konzept/image/schnell_5_Z_Y}{scale=0.6}{htbp}[z-Position Translation \textsf{schnell}][img:z_tran_schnell_y]
			\end{itemize}
			%
			Die Messerergebnisse sind in der Tabelle \vref{tab:auswertung_tran} zusammengefasst. Darauf erfolgen nun im Abschnitt \vref{ss:interpretation_tran} Interpretation und Diskussion.
			%
			\input{content/3_konzept/table/auswertung_tran}	 
	%
	%
	\subsection{Interpretation}\label{ss:interpretation_tran}
		Über alle Messungen und Positionen kam es, bezogen auf die Kontrollgruppe, zu Abweichungen. Dabei kam es zu einer maximalen Abweichung von \unit[2.203]{cm} bei der y-/z-Position und langsamer Geschwindigkeit, was bereits einem Fehler von \unit[44.1]{\%} entspricht. Diese beiden Messvoraussetzungen stellen hinsichtlich dieser grossen Abweichung eine Ausnahme dar, liegen die übrigen Messungen doch innerhalb von \unit[30]{\%}. Weiter ist auffallend, dass der Mittelwert bei den Postionen x und z kleiner als \unit[5.0]{cm} ausfiel, wohingegen die y-Position einen Wert hat, der darüber liegt. Eine letzte Auffälligkeit zeigt sich bei den Standardabweichungen der Messungen. Wiederum sticht die y-Position mit einem höheren Wert bei beiden Geschwindigkeiten heraus.\par
		%
		Die Hohe Abweichung bei \textsf{langsamer} Geschwindigkeit der Positionen y und z kann nicht begründet werden. Weder die relativ hohe Ungenauigkeit der Kontrollgruppe von geforderten $\pm$\unit[1.0]{cm} noch kann ein anderer Einfluss dieses Phänomen erklären. Denn die übrige Messung, die x-Position, hat bei der gleichen Geschwindigkeit lediglich einen absoluten Fehler von \unit[0.341]{cm}. Eine grössere Anzahl von Messungen könnte hier eventuell die Situation klären.\par 
		%
		Wie erwähnt, kommt es bei der y-Position, im Gegensatz zu den übrigen Positionen, zu einer Überschätzung der aktuellen Position. Dies kann auf einen Messfehler des Beschleunigungssensors zurückgeführt werden. Ein beständiger Offset auf den gemessenen Werten hat, bedingt durch die zweifache Integration, einen Drift zur Folge\footnote{In der Literatur ist dies unter dem Begriff \textsf{Integration Drift} bekannt \cite{lit:drift_int}.}. Durch die Bewegungsdetektion wird dies zwar weitestgehend unterdrückt, jedoch nur, wenn der Sensor in Ruhe ist. Bei einer Bewegung kommt dieses Fehlverhalten zum Zuge und hat entweder eine positive (y-Position) oder eine negative Verfälschung des Resultates zur Folge (x- und z-Position).
		%
		Der auffallende Punkt bezüglich der Standardabweichung der y-Position lässt sich ebenfalls begründen. Betrachtet man den Testaufbau und die Befestigungsart währende dieser Messung in Abbildung \vref{img:z_real}, so fällt auf, wie exponiert das \gls{g:myrio} in dieser Position ist. Durch diesen eher instabilen Aufbau ist der Sensor erhöhten Vibrationen ausgesetzt. Diese widerspiegeln sich in der Standardabweichung und sogar in der Messgenauigkeit (die Abweichungen von \unit[44.1]{\%}, respektive \unit[26.8]{\%} sind beide auffallend hoch).\par
		%
		Abschliessend kann die aufgestellte Hypothese \vref{hypo:translation} widerlegt werden. Die geforderte Genauigkeit von $\pm$\unit[1.0]{cm} kann, trotz der Berücksichtigung der Ungenauigkeit der Kontrollgruppe, von zwei Messungen (y- und z-Position bei der Geschwindigkeit \textsf{langsam}) nicht eingehalten werden. Weiter ist das Konzept sehr anfällig auf Vibrationen, wie die Messung y-Position \textsf{schnell} zeigt. Aus diesen Gründen gilt das Protokoll als nicht erfüllt. Es bleibt jedoch, die erwähnten Probleme näher zu untersuchen und für aussagekräftige Resultate eine höhere Anzahl Messungen durchzuführen.	
%
%
%Verifikation Translation und Rotation überlagert
\section{Verifikation Translation und Rotation überlagert}\label{s:verifikation_transaltion_rotation}
	%
	%
	\subsection{Grund/Zweck der Messung}
		Der Bewegungsablauf eines Knies umfasst eine Translation, die mit einer Rotation überlagert ist. Für eine abschliessende Überprüfung des Algorithmus sollen nun diese beiden Komponenten zeitgleich überprüft werden. Im Falle eines positiven Messergebnisses kann das Konzept, respektive der Algorithmus, als geeignet betrachtet und implementiert werden. Die Anforderungen an das Messergebnis sind in der Hypothese \vref{hypo:tran_rot} festgelegt.
		\begin{hypo}\label{hypo:tran_rot}
			Das Messergebnis ist eine Bewegung in der \gls{g:transversalebene}, wobei nur die y-Komponente interessiert. Sie ist dabei eine Widerspiegelung des realen Ablaufs mit einer Abweichung von $\pm$\unit[1.0]{cm}\footnote{Erläuterungen zur geforderten Messgenauigkeit sind im Abschnitt \vref{ss:messgenauigkeit} zu finden.}.
		\end{hypo}
	%
	%
	\subsection{Material/Testumgebung}\label{ss:testumgebung_tran_rot}
		Für eine aussagekräftige Messung muss eine Kniebewegung möglichst exakt nachgebildet werden können. Weiter sollten die Messungen reproduzierbar sein. Für diesen Zweck wurde eigens eine Mechanik konstruiert und aufgebaut.\par 
		%
		Der Simulator basiert auf Bosch-Profilen\footnote{Hergestellt von der Firma Bosch Rexroth AG \url{http://www.boschrexroth.com}.} und ist dadurch sehr anpassbar. Der Aufbau erlaubt es, einen vollständigen statischen Bewegungsablauf nachzubilden, jedoch ohne die horizontale Rotation zu berücksichtigen. Für eine konstante Geschwindigkeit des Ablaufs sorgt ein DC-Motor mit Rutschkupplung. Dieser wird mit einem DC-Netzteil gespiesen, was zugleich eine Steuerung der Geschwindigkeit ermöglicht (durch Variation der Spannung). Die Befestigung des \gls{g:myrio} M\low{1} erfolgt auf einer Platte, die wiederum auf dem Schwenkarm angebracht ist. Die Position ist dabei so gewählt, dass sie der Kniehöhe eines Durchschnittsmenschen entspricht. Für das Errechnen der Bewegungsbahn wird ausserdem ein Winkelmessgerät M\low{2} befestigt, das eine absolute Messung des Winkels erlaubt. Der komplette Aufbau ist in der Abbildung \vref{img:messaufbau_tran_rot} ersichtlich.
		%
		\image{content/3_konzept/image/messaufbau_tran_rot}{scale=0.2}{htbp}[Messaufbau Translation, Rotation überlagert][img:messaufbau_tran_rot]
		%
		Die Bedienung der Messeinrichtung kann auf zwei Arten erfolgen. Automatisch mit DC-Motor oder manuell von Hand (ermöglicht durch die Rutschkupplung). Im automatischen Betrieb kann die Geschwindigkeit, wie bereits zuvor erwähnt, mit Variation der angelegten Spannung eingestellt werden. Der zulässige Spannungsbereich des Motors liegt dabei zwischen \unit[8]{V} und \unit[12]{V}. Wird die Bewegung manuell ausgelöst, ist darauf zu achten, dass der Ablauf mit einer möglichst konstanten Geschwindigkeit erfolgt. Um unterschiedliche Auslenkungen überprüfen zu können, kann die Querverbindung stufenlos am Rotationsarm eingestellt werden\footnote{Markierung \textsf{TR1}, \textsf{TR2} und \textsf{TR3} am Rotationsarm.}. Eine Auflistung aller verwendeter Messmittel, inklusive ihrer geschätzten Messgenauigkeit ist in der Tabelle \vref{tab:messmittel_tran_rot} vermerkt.
		%
		\input{content/3_konzept/table/messmittel_tran_rot}	
	%
	%
	\subsection{Methoden}
		%
		\subsubsection*{Messgruppen}\label{sss:messgruppe_tran_rot}
			Die Messung wird mit zwei Messgruppen durchgeführt, wobei die eine als Testgruppe und die andere als Kontrollgruppe verwendet wird.	
			%
			\begin{itemize}
				%
				\item \textbf{Testgruppe} Die Testgruppe beinhaltet das \gls{g:myrio} M\low{1} mit integriertem Beschleunigungssensor. Die Daten werden während des Tests aufgezeichnet und später auf dem Computer mit \gls{g:matlab} verarbeitet. 
				%
				\item \textbf{Kontrollgruppe} Die Kontrollgruppe dient als Basis für die spätere Auswertung. Die Aufnahme der Daten erfolgt zum einen messtechnisch (Radius und Winkel) und zum anderen mathematisch (Berechnung der Pfadlänge).
			\end{itemize}
			%
			Das unterschiedliche Messverfahren stellt die unabhängige Variable in diesem Protokoll dar.
		%
		\subsubsection*{Testgruppe Messmethodik}
			Die Messmethodik der Testgruppe ist äquivalent zur Messmethodik des vorherigen Protokolls im Abschnitt \vref{ss:messmethodik_kontroll_tran}. Für die bessere Gliederung der Protokolle wurde dennoch eigens das \gls{g:matlab}-Skript \texttt{Check\_Translation\_Rotation\_final.m} erstellt. Für eine detaillierte Einsicht ins Skript sei auf den Anhang \vref{s:anhang_matlab} verwiesen.
		%
		\subsubsection*{Kontrollgruppe Messmethodik}
			Wie angetönt, verwendet die Kontrollgruppe messtechnische und mathematische Verfahren, um den zurückgelegten Weg zu ermitteln.  
			Gemessen wird mithilfe von Massstab M\low{4} und Winkelmesser M\low{2} die aktuelle Kniehöhe (konstant über alle Messungen hinweg) und der mögliche Winkelbereich $\alpha$ der aktuellen Auslenkung. Als Ausgangslage für die Aufnahme der skalaren Messgrössen dient die Abbildung \vref{img:messaufbau_dimensionen}. 
			%
			\image{content/3_konzept/image/messaufbau}{scale=0.5}{t}[Messaufbau - Messmethodik][img:messaufbau_dimensionen]
			%
			Die benötigten Grössen sind zum einen der Radius $r$ (gemessen vom Drehpunkt bis zur Position Beschleunigungssensor) und, davon abhängig, die Bogenlänge $b$ (entspricht der Pfadlänge des Bewegungsablaufs). Der Radius wird durch den Satz des Pythagoras bestimmt, wie die Gleichung \vref{eq:radius} zeigt. 
			\formula{
				r &= \sqrt{x^2+y^2}\\
				&=\sqrt{47^2+431^2}=\underline{433.56}
			}
			{
				r & Radius in mm\\
				x & vertikaler Abstand in mm\\
				y & horizontaler Abstand in mm\\
			}[eq:radius]
			%
			Die Bogenlänge $b$ kann anschliessend mit der Gleichung \vref{eq:kreissegement} unter Berücksichtigung des eingestellten Winkels $\alpha$ bestimmt werden.
			\formula{
					\alpha ' &= \frac{\alpha}{180}\cdot\pi\\[2ex]
					b&=r\cdot\alpha '
				}
				{
					r & Radius in mm\\
					\alpha & Winkel in Grad\\
					\alpha ' & Winkel in Rad\\
					b & Teilumfang in mm\\
				}[eq:kreissegement]
		%
		\subsubsection*{Testbeschreibungen}
			Es werden Messungen bei unterschiedlichen Auslenkungen durchgeführt. Dazu wird die Querverbindung an drei verschiedenen Positionen, erkenntlich anhand von Markierungen, angebracht (siehe Abbildung \vref{img:messaufbau_tran_rot}). Es wird insgesamt zwischen drei verschiedenen Auslenkungen unterschieden, wobei die Position des \gls{g:myrio} M\low{1} nicht verändert wird. 
			%
			\begin{itemize}
				\item \textbf{Auslenkung 1 \textsf{TR1}} Die erste Auslenkung beträgt \unit[7.5]{°}. Dazu wird die Querstrebe an der Position 1 befestigt, wie in Abbildung \vref{img:messaufbau_pos1} ersichtlich. Daraus ergibt sich unter Anwendung der Gleichung \vref{eq:kreissegement} eine Pfadlänge von \unit[56.75]{mm}.
				\image{content/3_konzept/image/messaufbau_querstrebe_pos_1}{scale=0.7}{htbp}[Querstreben-Position 1 (Angaben in \unit{mm})][Querstreben-Position 1][img:messaufbau_pos1]
				%
				\item \textbf{Auslenkung 2 \textsf{TR2}} Für eine mittelgrosse Auslenkung wird die Querstrebe an Position 2 bei \unit[30.0]{mm} befestigt. Damit ist ein Winkelbereich von \unit[15]{°} und eine Pfadlänge von \unit[113.5]{mm} möglich. Die Abbildung \vref{img:messaufbau_pos2} verdeutlicht die Befestigungsposition.
				\image{content/3_konzept/image/messaufbau_querstrebe_pos_2}{scale=0.7}{htbp}[Querstreben-Position 2 (Angaben in \unit{mm})][Querstreben-Position 2][img:messaufbau_pos2]
				%
				\item \textbf{Auslenkung 3 \textsf{TR3}} Die maximale Auslenkung von \unit[23.5]{°} wird bei der dritten Position erreicht. Der Befestigungspunkt ist bei \unit[60.0]{mm}, wie die Abbildung \vref{img:messaufbau_pos3} zeigt. Für die Pfadlänge ergibt sich mithilfe der Gleichung \vref{eq:kreissegement} \unit[174.04]{mm}.
				\image{content/3_konzept/image/messaufbau_querstrebe_pos_3}{scale=0.7}{htbp}[Querstreben-Position 3 (Angaben in \unit{mm})][Querstreben-Position 3][img:messaufbau_pos3]
			\end{itemize}
			%
			Der Messablauf umfasst insgesamt 4 Schritte, die für jede Auslenkung 15-mal wiederholt werden müssen.
			\begin{enumerate}
				\item Auslenkung einstellen, wie zuvor angeben 
				\item Den Schwenkarm genau senkrecht ausrichten
				\item Das \gls{g:labview}-Programm ausführen
				\item Messung durchführen
				\begin{enumerate}
					\item Für die Bestimmung der Rotationsmatrix \unit[4.0]{s} warten
					\item Den Rotationsarm einmal gegen den Uhrzeigersinn drehen und dabei auf eine möglichst konstante Geschwindigkeit achten
					\item In Ausgangsposition verharren bis \unit[11.0]{s} verstrichen sind
				\end{enumerate}
			\end{enumerate}
		%
		\subsubsection*{Datenauswertung}
			Die Messergebnisse der Testgruppe müssen hinsichtlich der Kontrollgruppe ausgewertet werden. Dabei ist die ermittelte Entfernung die abhängige Variable. Untersucht werden die absoluten und relativen Messfehler sowie die Standardabweichung der Messung. Durch die einmalig Umdrehung wird eine Endposition gleich der Startposition (Ursprung = \unit[0.0]{cm}) erwartet, was auch als Referenz zur Bestimmung der Fehlerabweichung dient. 
			%
			%\paragraph*{Auslenkung 1} 
			\begin{itemize}
				\item \textbf{Auslenkung 1} Über alle Messungen hinweg ergibt sich bei der \textsf{Auslenkung 1} ein mittlerer absoluter Fehler von \unit[-348.02]{cm} was relativ \unit[-6'960.5]{\%} entspricht. Die Messung an sich weist einen Mittelwert von \unit[-348.06]{cm} und eine Standardabweichung von \unit[76.39]{cm} auf. Das Ergebnis, inklusive des eingezeichneten Mittelwerts (blau) und der Standardabweichung (rot), ist in der Abbildung \vref{img:auslenkung_1_y} ersichtlich. 
				\image{content/3_konzept/image/auslenkung_1_Y}{scale=0.6}{htbp}[Translation Rotation Auslenkung 1][img:auslenkung_1_y]
			%
			%\paragraph*{Auslenkung 2}
				\item \textbf{Auslenkung 2} Bei der zweiten Auslenkung kann wie zuvor eine lineare Translation beobachtet werden. Gemittelt über alle Messungen, weist sie einen Mittelwert von \unit[-665.05]{cm} auf, was zugleich dem absoluten Fehler entspricht (der relative Fehler ist \unit[-13'301]{\%}). Die Standardabweichung beträgt \unit[82.57]{cm}. Die Abbildung \vref{img:auslenkung_2_y} zeigt die 15 durchgeführten Messungen.
				\image{content/3_konzept/image/auslenkung_2_Y}{scale=0.6}{htbp}[Translation Rotation Auslenkung 2][img:auslenkung_2_y]
			%
			%\paragraph*{Auslenkung 3}
				\item \textbf{Auslenkung 3} Wird die Auslenkung auf \unit[23.5]{°} erhöht, ergibt sich ein absoluter Fehler von \unit[-1'111.68]{cm}. Dies ist gleichbedeutend mit einem relativen Fehler von \unit[-22'233.5]{\%}. Der Mittelwert der Messungen beläuft sich auf \unit[-1'111.68]{cm}. Dies bei einer Standardabweichung von \unit[179.450]{cm}. Die Ergebnisse der dritten Auslenkung sind in der Abbildung \vref{img:auslenkung_3_y} dargestellt.\par 
				\image{content/3_konzept/image/auslenkung_3_Y}{scale=0.6}{htbp}[Translation Rotation Auslenkung 3][img:auslenkung_3_y]
			\end{itemize}
			%
			%
			Die Tabelle \vref{tab:auswertung_tran_rot} zeigt die beschriebenen Messergebnisse zusammengefasst. Sie dienen als Ausgangslage für die folgende Interpretation (siehe folgender Abschnitt \vref{ss:interpretation_tran_rot}).
			%
			\input{content/3_konzept/table/auswertung_tran_rot}
	%
	%
	\subsection{Interpretation}\label{ss:interpretation_tran_rot}
Bei allen Messungen der drei verschiedenen Auslenkungen sind Abweichungen, bezogen auf die Kontrollgruppe zu verbuchen. Die maximale Abweichung von \unit[-1'111.68]{cm}, was einem Fehler von \unit[-22'233.5]{\%} entspricht, sind bei den Messungen der \textsf{Auslenkung 3} aufgetreten. Die Abweichungen in \textsf{Auslenkung 1} und \textsf{2} sind zwar geringer als in \textsf{Auslenkung 3}, jedoch auch enorm gross (\textsf{Auslenkung 1} \unit[-348.02]{cm}, \textsf{Auslenkung 2} \unit[-665.05]{cm}).\par
%
Gegeben durch den Messaufbau ist eine sinusförmige Bewegung auf der y-Achse zu erwarten. Diese kann nicht reproduziert werden. Die Genauigkeit der Kontrollgruppe hat keinen Einfluss auf die grossen Abweichungen der Messungen. Da Start- und Endposition auf maximal \unit[1.0]{cm} genau angefahren werden kann. Diese Genauigkeit ist bei weitem kleiner als die gemessenen Abweichungen.\par
%
Wie schon in  Abschnitt \vref{ss:interpretation_tran} gesehen ist bei jeder Bewegung mit einem beständigem Offset ein Drift durch die zweifache Integration möglich. Dieser Drift wird, wenn der Sensor in Ruhe ist, durch die Bewegungsdetektion unterdrückt. Ist der Sensor in Bewegung, wird das Resultat durch diesen Drift zusätzlich verfälscht. Messungen haben jedoch gezeigt, dass dieser Drift nur einige cm auf einem Messdauer von \unit[10.0]{s} ausmacht, wie in Abbildung \vref{img:drift} im Anhang gezeigt. Dieser Drift hat im Vergleich zu den hier aufgetretenen Abweichungen einen kleinen Einfluss.
%
Die enormen Abweichungen können mit dem fehlerhaften Konzept begründet werden. Das Konzept ist so ausgelegt, dass nur Bewegungen in einer Ebene parallel zur z-Achse des \gls{g:worldframe} betrachtet werden können. Dabei wird die Orientierung des Sensors nur einmal kompensiert. Ändert nun die Orientierung des Sensors durch eine Rotation, so wird diese nicht mehr richtig kompensiert. Eine Projektion der Gravitation ist auf unserer x- und y-Achse vorhanden und wird mit integriert. Dadurch entsteht ein Drift. Dieser Drift führt zu den grossen Abweichungen der Messresultate.\par
%
Da bei der \textsf{Auslenkung 3} die grösste Rotation, bezogen auf die Drehung des Sensors, durchgeführt wird, sind bei diesen Messungen die Abweichungen am grössten. Die Erdbeschleunigung hat in diesem Fall einen deutlichen Einfluss auf die Messungen. Somit werden die x- und y-Komponenten stärker verfälscht, dementsprechend ist auch die Integration fehlerbehafteter.\par
%
Die Hypothese \vref{hypo:tran_rot} wird widerlegt. Die geforderte Genauigkeit von \unit[$\pm$1.0]{cm} kann nicht im entferntesten erreicht werden. Die Funktion des Konzeptes ist somit nicht gewährleistet. Das Protokoll gilt als nicht erfüllt.
%
%
%Validierung
\section{Validierung}
Die drei verschiedenen Verifikationen des Konzepts haben gezeigt, dass das Konzept für den Anwendungsfall am Knie fehlerbehaftet ist. In diesem Anwendungsfall kommen Bewegungen vor, welche zum einen einer Translation in der \gls{g:transversalebene} sowie einer Rotation entsprechen.\par 
%
Das Konzept ist bekanntlich in zwei Teile aufgeteilt. Der erste Teil dient zum Schätzen der Orientierung des Sensors, um anschliessend daraus die Kompensation zu berechnen. Dieser Teil des Konzeptes funktioniert gut, was in Abschnitt \vref{ss:rot} verifiziert wurde. Die Orientierung des Sensors vom \gls{g:bodyframe} in das \gls{g:worldframe} kann bei jeder Messung durchgeführt werden.\par
%
Das Konzept ist so ausgelegt, dass nur Bewegungen in einer zur z-Achse des \gls{g:worldframe} senkrecht stehenden Ebene, der \gls{g:transversalebene}, ausgewertet werden. Die Messungen der Verifikation der Translation zeigen auf, dass dies, wie in Abschnitt \vref{s:verifikation_translation} gezeigt, auch funktioniert. Auslenkungen in dieser Ebene können mit einem gewissen Fehler berechnet werden. Der Fehler entspricht dabei einer Über- respektive Unterschätzung der Distanz. Die Messungen zeigen untereinander eine im Verhältnis zur Genauigkeit der Kontrollgruppe\footnote{Genauigkeit der Kontrollgruppe $\pm$\unit[1.0]{cm} aufgrund der manuellen Bedienung.} erstaunlich geringe Standardabweichung von weniger als \unit[0.6]{cm} auf. Damit wird der zurückgelegte Weg zwar nicht exakt berechnet aber die Messungen derselben zurückgelegten Distanz weisen eine nur geringe Streuung auf.\par
% 
Die Verifikation der Translation mit überlagerter Rotation hingegen zeigen auf, dass der zweite Teil des Konzepts, in welchem die Bewegung berechnet wird, im zuvor definierten Anwendungsfall nicht funktioniert. Im Konzept wurde nicht beachtet, dass eine Rotation des Sensors vorkommt und dadurch dessen Orientierung ändert. In diesem Fall nimmt die Gravitation Einfluss auf die Messung. Je mehr der Sensor zusätzlich rotiert wird, desto grösser die Einwirkung durch die Projektion der Gravitation auf die Beschleunigung der Bewegung. Die Gravitation verfälscht die Beschleunigungsdaten der betrachteten Achsen mit einem additionalen \glqq DC-Anteil\grqq\, woraus der im Abschnitt \vref{s:verifikation_transaltion_rotation} ersichtliche Drift resultiert. Nicht erstaunlich sind in diesem Fall die grossen Abweichungen bei diesen Messungen.\par 
%
Ein wichtiger Punkt zur Verbesserung des Konzepts, ist, die Rotation laufend zu berechnen. In diesem Fall könnten Rotationen des Sensors kompensiert werden und die Gravitation hätte keinen Einfluss auf die Messungen.\par
%
Da das Konzept fehlerhaft ist, wird der Bewegungsablauf am Knie genauer analysiert\footnote{Die folgenden Berechnungen wurden mit dem \gls{g:matlab}-Skript \texttt{Dynamisch\_Statisch.m} im Anhang \vref{s:anhang_matlab} durchgeführt.}. Dazu wird ein einfaches Bewegungsmodell erstellt. Dieses ist in Abbildung \vref{img:dynamisch_statisch} dargestellt.\par
%
\image{content/3_konzept/image/dynamisch_statisch}{scale=0.9}{htbp}[Bewegungsmodell Knie][img:dynamisch_statisch]
%
Die Auslenkung des Knies kann als harmonische Funktion approximiert werden. Dabei müssen drei Parameter festgelegt werden. Diese sind die Kniehöhe $L$, die maximale laterale Auslenkung $d$ sowie die Frequenz der Bewegung $f_0$. Die laterale Auslenkung $x_l(t)$ kann somit folgendermassen beschrieben werden. 
%
\formula{
x_l(t) = d * sin(2  \pi  f_0  t)
}
{
x_l(t) & laterale Auslenkung\\ 
d & maximale laterale Auslenkung\\
f_0 & Frequenz der Bewegung
}[eq:auslenkung_weg]
%
Die laterale Beschleunigung $a_{l mov}(t)$ kann mittels der zweifachen Ableitung aus der lateralen Bewegung berechnet werden.
%
\formula{
a_{l mov}(t) &= \frac{\partial^2 x_l(t)}{\partial t^2}\\[2ex]
&= -(2 \pi f_0)^2 * d * sin(2 \pi f_0) 
}
{
a_{l mov}(t) & laterale Beschleunigung\\ 
d & maximale laterale Auslenkung\\
f_0 & Frequenz der Bewegung
}[eq:auslenkung_beschl]
%
Da bei der Bewegung zur Translation zusätzlich eine Rotation hinzukommt, wird die Gravitation auf die laterale Beschleunigung projiziert. Dies macht sich mit $a_{g l}(t))$ bemerkbar\footnote{Ist in Abbildung \vref{img:dynamisch_statisch} gut ersichtlich.}. Diese Projektion ist von $\alpha$, dem Winkel der Auslenkung, abhängig und kann mit der Höhe $L$ des Knies, der laterale Auslenkung $x_l(t)$ und der Erdbeschleunigung $g$ berechnet werden. Die Auslenkung $\alpha$ ist einfach mittels Trigonometrie zu berechnen.
%
\formula{
\alpha = sin(\frac{x_l(t)}{L})
}
{
\alpha & Auslenkung der Bewegung\\ 
x_l(t) & laterale Auslenkung\\
L & Länge des Knies
}[eq:auslenkung_beschl]
%
Da die laterale Auslenkung im Vergleich zur Kniehöhe deutlich kleiner ist, kann die Kleinwinkelnäherung angewendet werden ($\alpha = sin(\alpha)$). Die projiziert Gravitation $a_{l g}$ ist somit:
%
\formula{
a_{l g} = g*\frac{x_l(t)}{L}
}
{
a_{l g} & projizierte Gravitation\\ 
g 	&	Gravitationskonstante\\
x_l(t) & laterale Auslenkung\\
L & Länge des Knies
}[eq:auslenkung_beschl]
%   
Werden nun die Amplituden der lateralen Beschleunigung $a_{l mov}(t)$ und der projizierten Gravitation $a_{l g}$ bei verschiedenen Frequenzen verglichen, so wird eine kritisches Mass erreicht, wenn beide Amplituden gleich gross sind. Dazu werden die beiden Beschleunigungen gleich gesetzt. Das Vorzeichen bei $a_{l mov}(t)$ kann hier vernachlässigt werden, es entspricht nur einer Phasendrehung um \unit[180]{°}. 
%
\formula{
a_{l mov}(t) &= a_{l g} \\[2ex]
(2 \pi f_0)^2 * d * sin(2 \pi f_0) &= g*\frac{d * sin(2  \pi  f_0  t)}{L}
}
{
}[eq:auslenkung_beschl]
% 
Die maximale Auslenkung $d$ sowie die Abhängigkeit der Zeit kürzen sich weg; die Gleichung für die kritisch Frequenz $f_k$ lautet:
 %
\formula{
f_k = \sqrt{\frac{g}{(2\pi)^2*L}}
}
{
}[eq:auslenkung_beschl]
%
Diese kritische Frequenz liegt bei einer Kniehöhe von $L$ = \unit[50.0]{cm} auf $f_k$ = \unit[0.7]{Hz}. Ist die Frequenz der Bewegung viel grösser als diese Grenzfrequenz, so hat die projizierte Gravitation nahezu keinen Einfluss auf die resultierende Beschleunigung: Dies ist der dynamische Fall. Ist die Grenzfrequenz kleiner, so liegt der statische Fall vor, wo die Projektion der Gravitation grösser als die laterale Beschleunigung der Bewegung ist. Dies wurde in \gls{g:matlab} simuliert und in Abbildung \vref{img:kritische_freq} dargestellt.\par
%
\image{content/3_konzept/image/kritische_freq}{scale=0.8}{htbp}[kritische Frequenz statische, dynamische Bewegung][img:kritische_freq]
%
Aufgrund dieser Erkenntnis kann ein neuer Algorithmus entwickelt werden. Dieser Algorithmus gehört nicht mehr zu dieser Arbeit, sondern in die Pedenzenliste.