%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Titel:   Konzept
% Autor:   zursr1, gross10
% Datum:   28.05.2014
% Version: 0.0.1
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%:::Change-Log:::
% Versionierung erfolgt auf folgende Gegebenheiten: -1. Release Versionen
%                                                   -2. Neue Kapitel
%                                                   -3. Fehlerkorrekturen
%
% 0.0.0       Erstellung der Datei
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Konzept}\label{ch:konzept}

%
% Blockdiagramm
\section{Blockdiagramm}
Das Konzept kann teilweise aus dem beschriebenen Beispielprojekt in \todo{Referenz hinzufügen} extrahiert werden. Dort wurde wie schon gesagt eine ähnliche Aufgabenstellung gelöst. Durch die geringe Einarbeitungszeit konnten wir dort einige Ideen kopieren. Wir haben uns entschieden die Methode mit der doppelten Integration der Beschleunigung der Bewegung umzusetzen, wie in der Literaturstudie in \cite{lit:doubleint} gesehen.\par
%
Die Beschleunigung der Bewegung wird von einem auf dem Knie montierten drei Achsen Beschleunigungssensor aufgezeichnet. Die aufgezeichneten Beschleunigungsdaten enthalten zum einen die Erdbeschleunigung sowie zum andern die Bewegungsbeschleunigung. Uns  interessieren jedoch nur die Beschleunigung der Bewegung. Somit müssen wir zuerst die Erdbeschleunigung detektiert und diese von der Bewegungsbeschleunigung trennen. Anschliessend wird die Orientierung des Sensors, welcher in beliebiger weise im Raum steht, kompensiert. Hierbei ist als Bezugssystem die Erde gewählt (z-Achse entspricht der Erdbeschleunigung). Die kompensierten Beschleunigungsdaten haben wir nun noch zweimal zu integrieren, um auf die Bewegung schliessen zu können. Das gesamte Blockdiagramm ist in Abbildung \vref{img:blockdiagramm} ersichtlich. Auf die einzelnen Blöcke soll in den folgenden Unterkapiteln näher eingegangen werden.
%
% Blockdiagramm
\image{content/3_konzept/image/Blockdiagramm_Konzept}{scale=0.6}{htbp}[Blockdiagramm Konzept][img:blockdiagramm]
%
% Filterung
\subsection{Tiefpass-Filterung}
Als erste Aufgabe müssen wir die Beschleunigungsdaten auftrennen in die Erdbeschleunigung und die Beschleunigung der Bewegung. Beide Komponenten können wir weiterverwenden. Die Erdbeschleunigung ermöglicht uns das Schätzen der Orientierung (Abschnitt \vref{subsec:orientierungsschätzung}), die Beschleunigung der Bewegung wird zum Schätzen der Position mittels doppelter Integration verwendet.\par
%
Die Erdbeschnleunigung ist in jedem Falle eine konstante Beschleunigung. Aus diesem Grund können wir diese Beschleunigung wie eine DC-Komponente betrachten. Mit einer Tiefpass-Filterung können wir somit die Erdbeschleunigung von der Beschleunigung der Bewegung trennen. Als Tiefpassfilter wurde ein \todo{Überprüfen ob Filterwahl gut} \gls{ac:fir}-Filter gewählt. 
%
% Filterentwurf
\subsubsection*{Filterentwurf}
Das verwendete \gls{ac:fir}-Filter hat, wie der Name schon aussagt eine endliche Impulsantwort und ist somit gezwungen stabil. Der Phasengang dieser Filter ist linear. Die Gruppenlaufzeit entspricht der Zeit, durch die das Eingangssignal eines \gls{ac:lti}-Systems verzögert wird. Diese ist durch die lineare Phase bei einem \gls{ac:fir}-Filter konstant. Das Eingangssignal ist also am Ausgang nur verzögert und nicht verzerrt.\cite{lit:vongruenigen}\par
%
Zum Entwurf des Filters müssen zuerst einige Spezifikationen des Filters festgelegt werden. Diese sind in der Abbildung \vref{img:spezfilter} ersichtlich und sind:
%
\begin{itemize}
\item f\low{pass}: Durchlassfrequenz
\item f\low{stop}: Sperrfrequenz
\item A\low{pass}: Rippel im Durchlassbereich
\item A\low{stop}: Dämpfung im Sperrbereich 
\end{itemize}
%
% Filterentwurf
\image{content/3_konzept/image/filterentwurf}{scale=0.6}{htbp}[Spezifikationen eines Tiefpassfilters \cite{img:filterentwurf}][img:spezfilter] 
%
\subsubsection*{Fenstermethode}
Zum Entwurf des Filters wurde die einfachste sogenannte Fenstermethode gewählt. Bei dieser Methode geht man vom idealen Frequenzgang des Filters aus. Dieser Frequenzgang hat im Falle eines \gls{ac:tp}-Filters bis zur Durchlassfrequenz f\low{pass} den Wert 1, bei grösseren Frequenzen den Wert 0. Aus dem Frequenzgang H\low{ideal}($e^{j\Omega}$) können wir mit der inversen Fourier-Analyse auf die Impulsantwort h\low{ideal}(n) des Filters schliessen wie gemäss Gleichung \vref{eq:invfourier} in \cite{lit:vongruenigen} beschrieben.
%
\formula{
h_{ideal}(n) = \frac{1}{2\pi}\int_{-\pi}^{\pi} H_{ideal}(e^{j\Omega})*e^{j\Omega n}d\Omega\\
\Omega = k\frac{2\pi}{N}
}{
h_{ideal} & ideale Impulsantwort\\
H_{ideal} & idealer Frequenzgang\\
N & Anzahl Samples 
}[eq:invfourier] \todo{N richtig benamsen/überprüfen}
%
Diese ideale Impulsantwort ist durch den Sprung an der Durchlassfrequenz unendlich lang und somit nicht realisierbar. Eine einfache Lösung ist, die Impulsantwort mit einem Fenster zu begrenzen. Somit erhält man die Impulsantwort des \gls{ac:fir}-Filters wie in Gleichung \vref{eq:impfir} durch die Multiplikation des Fensters mit der idealer Impulsantwort des Filters.
%
\formula{
h[n]=h_{ideal}[n]w[n]
}{
h & approximierte Impulsantwort\\
h_{ideal} & ideale Impulsantwort\\
w & Fensterfunktion
}[eq:impfir]
%
% Schätzung der Orientierung
\subsection{Schätzung der Orientierung}\label{subsec:orientierungsschätzung}
Um die Bewegung des Sensors im Bezugssystem des Betrachters darstellen zu können, muss die Orientierung des Sensors bekannt sein. Als Bezugssystem verwenden wir die Erde, bei welcher die z-Achse des Koordinatensystems parallel zur Erdbeschleunigung liegt. Mit dem Gravitätsvektor a\low{g} und der gemessenen Erdbeschleunigung des Sensors können wir mit einfachen grundlegenden Vektoroperationen auf den Zwischenwinkel sowie auf die Richtung der Rotationsachse zwischen den beiden Betrachtungssystemen schliessen. Der Zwischenwinkel zweier Vektoren können wir über das Skalarprodukt berechnen. Nach Papula \cite{lit:papula} \todo{Seite anpassen bei Papula}
%
	
\subsection{Verzögerung, Berechnung der Bewegungsbeschleunigung}
%
\subsection{Rotation}
%
\subsection{Integration}
%
%
%Software
\section{Software}\label{s:konzept:sw}
	%
	\subsection{Rohdaten aufzeichnen}\label{ss:rohdaten_aufzeichnen}
	%
	\subsection{myRIO Posture Estimation}
%
%
%Verifikation Translation
\section{Verifikation Translation}\label{s:verifikation_translation}
	%
	%
	\subsection{Grund/Zweck der Messung}
		Die Verifikation der Translation stellt das erste von drei Experimental-Protokollen\footnote{die übrigen Protokolle sind in den Abschnitten \vref{s:verifikation_rotation} und \vref{s:verifikation_transaltion_rotation} zu finden} dar, die folgend für die Validierung des Konzepts als Ausgangslagen dienen sollen.  Ziel der Messung ist es den Algorithmus hinsichtlich einer linearen Translation zu überprüfen. Dabei gilt es relevante Fakten wie Genauigkeit und Dynamik zu extrahieren und für die Validierung festzuhalten. Bei auftretenden Diskrepanzen muss das Konzept überarbeitet und dieses Protokoll wiederholt werden. Das Erfüllen	
	%
	%
	\subsection{Material/Testumgebung}
		\input{content/3_konzept/table/messmittel}	
		\image{content/3_konzept/image/messaufbau}{scale=0.6}{htbp}[Messaufbau - Dimensionen][img:messaufbau_dimensionen]
		\input{content/3_konzept/table/messaufbau}
	%
	%
	\subsection{Methoden}
		%
		\subsubsection*{Messgruppen}\todo{unabhängige Variabel}
			Es werden zwei Messgruppen definiert. Die eine dient als Testgruppe und die andere als Kontrollgruppe. 
			%
			\begin{itemize}
				%
				\item \textbf{Testgruppe} Die Testgruppe repräsentiert das \gls{g:myrio}, das zur Aufzeichnung der Beschleunigungsdaten benötigt wird. Dabei werden die Daten nur gespeichert und nicht verarbeitet\footnote{Für detailliertere Informationen zur Aufzeichnung sei auf den Abschnitt \vref{ss:rohdaten_aufzeichnen} verwiesen}. Die Signalverarbeitung erfolgt zu einem späteren Zeitpunkt auf einem Computer mit Hilfe von \gls{g:matlab}.
				%
				\item \textbf{Kontrollgruppe} Die zweite Gruppe stellt die direkte Messung mit Massstab dar. Sie ist gleichzeitig die Kontrollgruppe, die schlussendlich bei der Interpretation als Ausgangslage gilt.
			\end{itemize}
			%
			Die Messmethodik stellt bei den beschriebenen Gruppen die unabhängige Variabel dar.
		%
		\subsubsection*{Testbeschreibungen}\todo{Ablauf}
		\subsubsection*{Datenauswertung}\todo{abhängige Variabel}
		\formula{
			r &= \sqrt{x^2+y^2}\\
			&=\sqrt{47^2+515^2}=\underline{517.14}
		}
		{
			r & Radius in mm\\
			x & vertikaler Abstand in mm\\
			y & horizontaler Abstand in mm\\
		}[eq:radius]
		%
		\formula{
			\alpha ' &= \frac{\alpha}{180}\cdot\pi\\[1ex]
			&= \frac{21}{180}\cdot\pi = \underline{0.366}\\[2ex]
			b&=r\cdot\alpha '\\
			&=517.14\cdot 0.366=\underline{189.54}
		}
		{
			r & Radius in mm\\
			\alpha & Winkel in Grad\\
			\alpha ' & Winkel in Rad\\
			b & Teilumfang in mm\\
		}[eq:kreissegement]
	%
	%
	\subsection{Kontrollgruppe}
	%
	%
	\subsection{Interpretation}\todo{Histogramm, Gruppenvergleich,Messfehler}
%
%
%Verifikation Rotation
\section{Verifikation Rotation}\label{s:verifikation_rotation}
	%
	%
	\subsection{Grund/Zweck der Messung}
	%
	%
	\subsection{Material/Testumgebung}
		Zur Aufzeichnung eines Bewegungsablaufes des Knies wurde eine Mechanik zur Simulation erstellt. Sie basiert auf Bosch-Profilen\footnote{Hergestellt von der Firma Bosch Rexroth AG: \url{http://www.boschrexroth.com}} und ist durch das sehr anpassbar. Die Simulation ermöglicht es einen statischen Bewegungsablauf nachzubilden. Dabei wird aktuell nur die seitliche Auslenkung des Knies berücksichtigt. Die ebenfalls vorhandene Rotation wird in diesem Projekt nicht
		\input{content/3_konzept/table/messmittel}	
		\image{content/3_konzept/image/messaufbau}{scale=0.6}{htbp}[Messaufbau - Dimensionen][img:messaufbau_dimensionen]
		\input{content/3_konzept/table/messaufbau}
	%
	%
	\subsection{Methoden}
		%
		\subsubsection*{Messgruppen}\todo{unabhängige Variabel}
			
		%
		\subsubsection*{Testbeschreibungen}\todo{Ablauf}
		\subsubsection*{Datenauswertung}\todo{abhängige Variabel}
		\formula{
			r &= \sqrt{x^2+y^2}\\
			&=\sqrt{47^2+515^2}=\underline{517.14}
		}
		{
			r & Radius in mm\\
			x & vertikaler Abstand in mm\\
			y & horizontaler Abstand in mm\\
		}[eq:radius]
		%
		\formula{
			\alpha ' &= \frac{\alpha}{180}\cdot\pi\\[1ex]
			&= \frac{21}{180}\cdot\pi = \underline{0.366}\\[2ex]
			b&=r\cdot\alpha '\\
			&=517.14\cdot 0.366=\underline{189.54}
		}
		{
			r & Radius in mm\\
			\alpha & Winkel in Grad\\
			\alpha ' & Winkel in Rad\\
			b & Teilumfang in mm\\
		}[eq:kreissegement]
	%
	%
	\subsection{Kontrollgruppe}
	%
	%
	\subsection{Interpretation}\todo{Histogramm, Gruppenvergleich,Messfehler}
%
%
%Verifikation Translation mit anschliessender Rotation
\section{Verifikation Translation mit anschliessender Rotation}\label{s:verifikation_transaltion_rotation}
	%
	%
	\subsection{Grund/Zweck der Messung}
	%
	%
	\subsection{Material/Testumgebung}
		Zur Aufzeichnung eines Bewegungsablaufes des Knies wurde eine Mechanik zur Simulation erstellt. Sie basiert auf Bosch-Profilen\footnote{Hergestellt von der Firma Bosch Rexroth AG: \url{http://www.boschrexroth.com}} und ist durch das sehr anpassbar. Die Simulation ermöglicht es einen statischen Bewegungsablauf nachzubilden. Dabei wird aktuell nur die seitliche Auslenkung des Knies berücksichtigt. Die ebenfalls vorhandene Rotation wird in diesem Projekt nicht
		\input{content/3_konzept/table/messmittel}	
		\image{content/3_konzept/image/messaufbau}{scale=0.6}{htbp}[Messaufbau - Dimensionen][img:messaufbau_dimensionen]
		\input{content/3_konzept/table/messaufbau}
	%
	%
	\subsection{Methoden}
		%
		\subsubsection*{Messgruppen}\todo{unabhängige Variabel}
			
		%
		\subsubsection*{Testbeschreibungen}\todo{Ablauf}
		\subsubsection*{Datenauswertung}\todo{abhängige Variabel}
		\formula{
			r &= \sqrt{x^2+y^2}\\
			&=\sqrt{47^2+515^2}=\underline{517.14}
		}
		{
			r & Radius in mm\\
			x & vertikaler Abstand in mm\\
			y & horizontaler Abstand in mm\\
		}[eq:radius]
		%
		\formula{
			\alpha ' &= \frac{\alpha}{180}\cdot\pi\\[1ex]
			&= \frac{21}{180}\cdot\pi = \underline{0.366}\\[2ex]
			b&=r\cdot\alpha '\\
			&=517.14\cdot 0.366=\underline{189.54}
		}
		{
			r & Radius in mm\\
			\alpha & Winkel in Grad\\
			\alpha ' & Winkel in Rad\\
			b & Teilumfang in mm\\
		}[eq:kreissegement]
	%
	%
	\subsection{Kontrollgruppe}
	%
	%
	\subsection{Interpretation}\todo{Histogramm, Gruppenvergleich,Messfehler}
%
%
%Validierung
\section{Validierung}
\todo{Auswertung Konzept}
